<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>酒店详情-地图</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link type="text/css" href="styles/style.css" rel="stylesheet">
    <link type="text/css" href="css/hdetail.css" rel="stylesheet">
    <style type="text/css">
        .m-div{
            position: absolute;
            top:45%;
            left: 37%;
        }
        .label{
            width: 255px;height: 53px;
            border: 1px solid #CCCCCC;
            border-radius: 5px;
            background-color: white;
            text-align: center;
            font-size: 1.5rem;
            line-height:53px ;
        }
        .triangle{
            position: relative;
            margin-left: 117.5px;
            margin-top: -1px;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid white;
        }
    </style>
    <script src="http://api.map.baidu.com/api?v=2.0&ak=7Aww1eFPhuX793cEm0ww1bxm" type="text/javascript"></script>
    <script>
        window.onload=function() {
        	
            function SquareOverlay(center,length,height){
                this._center = center;
                this._length = length;
                this._height = height;
            }
            SquareOverlay.prototype = new BMap.Overlay();
            SquareOverlay.prototype.initialize = function(map){
                this._map = map;
                var div = document.createElement("div");
                div.className = "m-div";
                var label = document.createElement("div");
                label.className = "label";
                label.innerHTML = "1-12-2 Dougenzaka shibuya-ku";
                div.appendChild(label);
                var triangle = document.createElement("div");
                triangle.className = "triangle";
                div.appendChild(triangle);
                map.getPanes().markerPane.appendChild(div);
                this._div = div;
                return div;
            };
            SquareOverlay.prototype.draw = function(){
                var position = this._map.pointToOverlayPixel(this._center);console.log(position);
                this._div.style.left = position.x - this._length / 2 + "px";
                this._div.style.top = position.y - this._height / 2 + "px";
            };
            var myLabel = new SquareOverlay(poi,257,64);
        	// 百度地图API功能
    var map = new BMap.Map('map');
    var poi = new BMap.Point(121.491, 31.233);
    map.centerAndZoom(poi, 16);
    map.enableScrollWheelZoom();
    map.enableDoubleClickZoom();
    var searchInfoWindow = null;
		
    var marker = new BMap.Marker(poi); //创建marker对象
    /*marker.enableDragging(); //marker可拖拽*/
    marker.addEventListener("click", function(e){
	    //searchInfoWindow.open(marker);
    });
    map.addOverlay(marker); //在地图中添加marker
    addIcon();map.addOverlay(myLabel);
//然后监听zoomend事件
map.addEventListener("zoomend", function () {
	var that = this;
	var Z = that.getZoom();
delIcon();addIcon();//alert('over'+Z);
});
function addIcon(){
	var icon = new BMap.Icon("images/loc.png",new BMap.Size(28,38),{
       anchor:new BMap.Size(14,38)
       //,infoWindowAnchor: new BMap.size(14,0)
    });
    var marker = new BMap.Marker(poi,{
        icon:icon
    });
    map.addOverlay(marker);
    map.addOverlay(myLabel);
}
function delIcon(){
    map.clearOverlays(marker);
}
            /*var mp = new BMap.Map("map");
            var point;
            function getPoint(x, y) {
                point = new BMap.Point(x, y);
                return point;
            }
            mp.centerAndZoom(getPoint(121.491, 31.233), 16);
            var icon = new BMap.Icon("images/loc.png",new BMap.Size(28,38),{
               anchor:new BMap.Size(14,38),
               infoWindowAnchor: new BMap.size(14,0)
            });
            var marker = new BMap.Marker(getPoint(121.491, 31.233),{
                icon:icon
            });
            mp.addOverlay(marker);*/

            
        }
    </script>
</head>
<body>
    <div class="all-elements">
        <!--  顶部   -->
        <div class="top" id="vlm-login">
            <a href="#" class="d-icons"></a>
            <p class="d-p1">东京东急涩谷卓越大酒店<br>(Shibuya Excel Hotel Tokyu Tokyo)</p>
        </div>
        <!--  地图   -->
        <div id="map" style="width:100%;height:100%;"></div>
    </div>
</body>
</html>