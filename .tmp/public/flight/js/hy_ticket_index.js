/*! asiatravel FE team at-h5-nodejs-----2016-05-19T15:21:43 */
var _ExHotCity={Parameters:"",ForeEndType:3,Code:"0081"},_InHotCity={Parameters:"",ForeEndType:3,Code:"0082"},ticketIndexModal={"double":function(){var a={start:this.reDate(document.querySelector(".double-date-one").innerHTML),end:this.reDate(document.querySelector(".double-date-two").innerHTML)},b={};b[a.start]="去程",b[a.end]="返程";new TicketDate({id:"ori-des-Date",num:13,time:b,sClass1:"double-date",type:"Return",_word:{tip:["去程","返程"]},dateObj:a})},single:function(){var a={start:this.reDate(document.querySelector(".single-date").innerHTML)};new TicketDate({id:"chooseDate-single",num:13,time:a,sClass1:"enterDate",type:"Oneway",_word:{tip:["去程"]}})},reDate:function(a){var b=/(\d{1,2})月(\d{1,2})日/g,c=b.exec(a);return c[1]=parseInt(c[1])<10?"0"+parseInt(c[1]):parseInt(c[1]),c[2]=parseInt(c[2])<10?"0"+parseInt(c[2]):parseInt(c[2]),(new Date).getFullYear()+"-"+c[1]+"-"+c[2]},singleAndDoubleTangle:function(){var a=document.querySelector("#double"),b=document.querySelector("#single");document.querySelector(".hTab").onclick=function(c){var c=c||window.event,d=c.target||c.srcElement;d.className.indexOf("singleTrip")>-1?(a.style.display="none",b.style.display="block",d.style.borderBottom="0.2rem solid  rgb(255, 180, 19)",d.style.color="rgb(255, 180, 19)",document.querySelector(".doubleTrip").style.borderBottom="none",document.querySelector(".doubleTrip").style.color="rgb(102, 102, 102)"):d.className.indexOf("doubleTrip")>-1&&(b.style.display="none",a.style.display="block",d.style.borderBottom="0.2rem solid  rgb(255, 180, 19)",d.style.color="rgb(255, 180, 19)",document.querySelector(".singleTrip").style.borderBottom="none",document.querySelector(".singleTrip").style.color="rgb(102, 102, 102)")}},storageUtil:{set:function(a,b){var c=window.localStorage;c.setItem(a,JSON.stringify({data:b}))},get:function(a){var b=window.localStorage,c=b.getItem(a),d=JSON.parse(c);return null!=d?d.data:void 0}},addHandler:function(a,b,c){document.addEventListener?this.addHandler=function(a,b,c){a.addEventListener(b,c,!1)}:document.attachEvent?this.addHandler=function(a,b,c){a.attachEvent("on"+b,function(){c.call(a)})}:this.addHandler=function(a,b,c){a["on"+b]=c},this.addHandler(a,b,c)},returnCityCode:function(a){for(var b="",c="domestic",d=0;d<internationalCities.length;d++)if(internationalCities[d].cityNameCN==a.innerHTML){b=internationalCities[d].cityCode,c="international";break}if(!b)for(var e=0;e<domesticCities.length;e++)if(domesticCities[e].cityNameCN==a.innerHTML){b=domesticCities[e].cityCode,c="domestic";break}return{cityCode:b,type:c}},returnCabinClass:function(a){var b="";switch(a){case"经济舱":b="Economy";break;case"商务舱":b="Business";break;case"头等舱":b="First";break;case"豪华经济舱":b="EconomyPremium";break;default:b="All"}return b},toTicketList:function(){var a=ticketIndexModal,b=document.querySelector("#ticket-search-button"),c=document.querySelector(".city-choose-tip");this.addHandler(b,"click",function(){var b=("block"==document.querySelector("#single").style.display?document.querySelector("#single"):document.querySelector("#double"),document.querySelectorAll(".city-search")),d="",e="",f="",g="",h="",i="",j="",k={},l="",m="",n="",o={},p={};if(b[0].innerHTML==b[1].innerHTML)c.innerHTML="请确保出发与到达为不同城市！",c.style.display="block",a.timer=window.setTimeout(function(){c.style.display="none",window.clearTimeout(a.timer),a.timer=null},3e3);else if("block"==document.querySelector("#double").style.display){o=a.returnCityCode(b[0]),p=a.returnCityCode(b[1]),d=o.cityCode,e=p.cityCode,f=a.reDate(document.querySelector(".ori-des-Date").querySelectorAll(".dateNumber")[0].innerHTML),g=a.reDate(document.querySelector(".ori-des-Date").querySelectorAll(".dateNumber")[1].innerHTML),h=document.querySelector("#double span.adult-number").innerHTML,i=document.querySelector("#double span.child-number").innerHTML,j=a.returnCabinClass(document.querySelector("#double .double-cabin-choose").innerHTML),k.CityCodeFrom=d,k.CityCodeTo=e,k.interNationalOrDomestic="domestic"==o.type&&"domestic"==p.type?"domestic":"international",k.DepartDate=f,k.ReturnDate=g,k.CabinClass=j,k.RouteType="Return",k.IsHideSharedFlight=!1,k.IsDirectFlight=!1,k.NumofAdult=h,k.NumofChild=i,k.DepartStartHour="00",k.DepartEndHour="24",k.PriorityRule=0,k.pageNo=1,k.pageSize=10,k.hasTax=!0,k.IsDesc="false",k.fromCity=b[0].innerHTML,k.toCity=b[1].innerHTML,a.storageUtil.set("ticketSearchedInfo",k);for(var q in k)l+="&"+q+"="+k[q];l=l.slice(1),document.location.href="ticket_double_list.html?"+l}else{m=parseInt(document.querySelector(".adult-number").innerHTML),n=parseInt(document.querySelector(".child-number").innerHTML),o=a.returnCityCode(b[0]),p=a.returnCityCode(b[1]),d=o.cityCode,e=p.cityCode,f=a.reDate(document.querySelector("#chooseDate-single").querySelector(".dateNumber").innerHTML),h=document.querySelector("#single span.adult-number").innerHTML,i=document.querySelector("#single span.child-number").innerHTML,j=a.returnCabinClass(document.querySelector("#single .single-cabin-choose").innerHTML),k.CityCodeFrom=d,k.CityCodeTo=e,k.interNationalOrDomestic="domestic"==o.type&&"domestic"==p.type?"domestic":"international",k.DepartDate=f,k.CabinClass=j,k.RouteType="Oneway",k.IsHideSharedFlight=!1,k.IsDirectFlight=!1,k.NumofAdult=m,k.NumofChild=n,k.DepartStartHour="00",k.DepartEndHour="24",k.PriorityRule=0,k.IsDesc="false",k.pageNo=1,k.pageSize=10,k.hasTax=!0,k.fromCity=b[0].innerHTML,k.toCity=b[1].innerHTML,a.storageUtil.set("ticketSearchedInfo",k);for(var r in k)l+="&"+r+"="+k[r];l=l.slice({from:b[0].innerHTML,to:b[1].innerHTML}),document.location.href="ticket_single_list.html?"+l}},!1)},toCitySearch:function(){var a=document.querySelector(".place"),b=document.querySelector(".city-list-choose"),c=document.getElementById("city-input-zone"),d=(document.querySelector(".city-list-searched"),a.querySelectorAll(".city-search"),""),e=ticketIndexModal,f=document.querySelector(".city-list-searched"),g=document.createElement("div"),h=document.querySelector(".air_content"),i=document.querySelector(".domestic-city"),j=document.querySelector(".international-city"),k=document.querySelector(".domestic-top-line"),l=document.querySelector(".international-top-line");a.onclick=function(a){var a=a||window.event,m=a.target||a.srcElement;m.className.indexOf("city-search")>-1&&(e.celement=m,d=e.checkLocation(m.innerHTML),c.placeholder="domestic"==d?"北京/beijing/bj/bjs/中国":"新加坡/xinjiapo/xjp/sin",c.value="",b.style.display="block","domestic"==d?(i.style.display="block",j.style.display="none",k.className="domestic-top-line addFontStyle",l.className="international-top-line"):(j.style.display="block",i.style.display="none",k.className="domestic-top-line",l.className="international-top-line addFontStyle"),f.style.display="none",f.innerHTML="",g.className="maskCity",document.querySelector("#tpls").appendChild(g),h.style.display="none")}},changeItem:function(a){for(var b=document.querySelectorAll(".item-span"),c=0;c<b.length;c++)b[c].className="item-span";b[a].className="item-span dot"},startHandler:function(a){ticketIndexModal.preventDefault(a),ticketIndexModal.stopPropagation(a),ticketIndexModal.autoTimerInt&&(window.clearInterval(ticketIndexModal.autoTimerInt),ticketIndexModal.autoTimerInt=null),ticketIndexModal.isAnimation?ticketIndexModal.isAnimation=!0:ticketIndexModal.tempStart=a.targetTouches[0].pageX},moveHandler:function(a){ticketIndexModal.preventDefault(a),ticketIndexModal.stopPropagation(a);var b=document.querySelector(".frontPicUl");b.style.left=parseFloat(b.style.left)+a.targetTouches[0].pageX-ticketIndexModal.tempStart+"px",ticketIndexModal.tempStart=a.targetTouches[0].pageX},endHandler:function(a){ticketIndexModal.preventDefault(a),ticketIndexModal.stopPropagation(a);var b,c=-(document.querySelectorAll(".frontPicLi").length-2)*window.innerWidth,d=-window.innerWidth,e=parseFloat(document.querySelector(".frontPicUl").style.left),f=e-ticketIndexModal.tempCurLeft,g=1e3;b=0>f&&Math.abs(f)>=window.innerWidth/4?ticketIndexModal.tempCurLeft-window.innerWidth:f>0&&Math.abs(f)>=window.innerWidth/4?ticketIndexModal.tempCurLeft+window.innerWidth:ticketIndexModal.tempCurLeft,b>d?b=d:c>b&&(b=c),g=Math.abs((b-parseFloat(document.querySelector(".frontPicUl").style.left))/window.innerWidth)*g,ticketIndexModal.tempCurLeft=b,$(".frontPicUl").animate({left:b},g),ticketIndexModal.changeItem(Math.abs(Math.floor(b/window.innerWidth))-1),ticketIndexModal.isAnimation=!1,ticketIndexModal.autoMove()},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},tangleCity:function(){var a=document.querySelector(".place");a.current=0,this.addHandler(a,"click",function(a){var b=this.querySelector(".origin ").innerHTML,c=this.querySelector(".destination").innerHTML,a=a||window.event,d=a.target||a.srcElement;if(-1!=d.className.indexOf("span-target")){var e=this.querySelector("span");e.style.transition="0.7s all ease",e.style.webkitTransition="0.7s all ease",this.current=this.current+180,e.style.transform="rotate("+this.current+"deg)",e.style.webkitTransform="rotate("+this.current+"deg)",this.querySelector(".origin ").innerHTML=c,this.querySelector(".destination ").innerHTML=b}})},createWrap:function(){var a=document.createElement("div"),b="",c=document.querySelector(".all-elements");a.className="city-list-choose",b+='<header class="clearfix"><i class="fl"></i><div class="cl_search"><input type="text" placeholder="北京/beijing/bj/bjs/中国" id="city-input-zone"><i></i></div></header><div class="city-content jcity-content"><div class="hTab c-htab"><div class="domestic-top-line addFontStyle">国内</div><div class="international-top-line">国际</div></div><div class="domestic-city"><ul class="city-classifying"><li class="title-tip d-cur-city"><a class="target" name="CURR"></a><h4>当前</h4><ul class="city-content"><li class="city-content-item focus city-word">北京</li></ul></li><li class="title-tip d-his-city-ele d-his-city"><a class="target" name="HIST"></a><h4>历史选择</h4><ul class="city-content history-choose-ul"></ul></li><li class="title-tip d-re-hot-city"><a class="target" name="HOTT"></a><h4>热门城市</h4><ul class="city-content city-content-hot"></ul></li></ul><ul class="city-list-details"><li class="city-list-details-info"><h4>A</h4><ul class="city-list-details-content"></ul></li><li class="city-list-details-info"><h4>B</h4><ul class="city-list-details-content"></ul></li><li class="city-list-details-info"><h4>C</h4><ul class="city-list-details-content"></ul></li></ul></div><div class="international-city"><ul class="city-classifying"><li class="title-tip i-cur-city"><a class="target" name="ICURR"></a><h4>当前</h4><ul class="city-content"><li class="city-content-item focus city-word">北京</li></ul></li><li class="title-tip i-his-city-ele i-his-city"><a class="target" name="IHIST"></a><h4>历史选择</h4><ul class="city-content"></ul></li><li class="title-tip i-re-hot-city"><a class="target" name="IHOTT"></a><h4>热门城市</h4><ul class="city-content city-content-hot"></ul></li></ul><ul class="city-list-details"><li class="city-list-details-info"><h4>A</h4><ul class="city-list-details-content"></ul></li><li class="city-list-details-info"><h4>B</h4><ul class="city-list-details-content"></ul></li><li class="city-list-details-info"><h4>C</h4><ul class="city-list-details-content"></ul></li></ul></div><ul class="city-list-searched" style="display: none;"></ul></div><div class="right-side"><div class="cur-word"><div class="special-tip"><span class="cur-city"><a href="#CURR">当前</a></span><span class="his-city"><a href="#HIST">历史</a></span><span class="re-hot-city"><a href="#HOTT">热门</a></span></div><div class="city-pin-fir"><a class="letter" href="#A">A</a><a class="letter" href="#B">B</a><a class="letter" href="#C">C</a><a class="letter" href="#D">D</a><a class="letter" href="#E">E</a><a class="letter" href="#F">F</a><a class="letter" href="#G">G</a><a class="letter" href="#H">H</a><a class="letter" href="#I">I</a><a class="letter" href="#J">J</a><a class="letter" href="#K">K</a><a class="letter" href="#L">L</a><a class="letter" href="#M">M</a><a class="letter" href="#N">N</a><a class="letter" href="#O">O</a><a class="letter" href="#P">P</a><a class="letter" href="#Q">Q</a><a class="letter" href="#R">R</a><a class="letter" href="#S">S</a><a class="letter" href="#T">T</a><a class="letter" href="#U">U</a><a class="letter" href="#V">V</a><a class="letter" href="#W">W</a><a class="letter" href="#X">X</a><a class="letter" href="#Y">Y</a><a class="letter" href="#Z">Z</a></div></div></div>',a.innerHTML=b,c.appendChild(a)},selectCity:function(a){var b;return b="countryCode"==a.filterColumn&&"NOTCN"==a.value?_ExHotCity:"countryCode"==a.filterColumn&&"CN"==a.value?_InHotCity:_InHotCity},getHotCity:function(a){function b(a){var b={},d=a;if(b=d,!d.success)return c(e,b.success,b.message);var e=d.data;return c(e,b.success,b.message)}function c(b,c,e){"NOTCN"==a?d.intHotCity=b:d.demHotCity=b,void 0!=d.demHotCity&&void 0!=d.intHotCity&&d.createHotCityContent(d.demHotCity,d.intHotCity)}var d=this,e={};e.filterColumn="countryCode",e.value=a;var f=this.selectCity(e),g=JSON.stringify(f);vlm.loadJson("",g,b)},createHotCityContent:function(a,b){for(var c=document.querySelector(".domestic-city ul.city-content-hot"),d=document.querySelector(".international-city ul.city-content-hot"),e="",f="",g=0;g<a.length;g++)f+='<li class="city-content-item hot city-word">'+a[g].cityChineseName+"</li>";for(var h=0;h<b.length;h++)e+='<li class="city-content-item hot city-word">'+b[h].cityChineseName+"</li>";c.innerHTML=f,d.innerHTML=e},addContent:function(){var a=document.querySelector(".domestic-city ul.city-list-details"),b=document.querySelector(".international-city ul.city-list-details"),c=(document.querySelector(".d-his-city-ele"),document.querySelector(".i-his-city-ele"),""),d="";for(var e in domesticCitiesData)if("0"!=tem){c+='<li class="city-list-details-info d'+e.toUpperCase()+'-Link"><a class="target" name="'+e.toUpperCase()+'"></a><h4>'+e.toUpperCase()+'</h4><ul class="city-list-details-content">';for(var f=0;f<domesticCitiesData[e].length;f++)c+='<li class="city-list-name city-word">'+domesticCitiesData[e][f].cityNameCN+"</li>";c+="</ul>"}for(var g in internationalCitiesData){d+='<li class="city-list-details-info d'+g.toUpperCase()+'-Link"><a class="target" name="IN'+g.toUpperCase()+'"></a><h4>'+g.toUpperCase()+'</h4><ul class="city-list-details-content">';for(var h=0;h<internationalCitiesData[g].length;h++)d+='<li class="city-list-name city-word">'+internationalCitiesData[g][h].cityNameCN+"</li>";d+="</ul>"}a.innerHTML=c,b.innerHTML=d},createHisCity:function(){var a=window.localStorage,b=[],c=[];b=null!=a.getItem("dHisCity")?JSON.parse(a.getItem("dHisCity")):{type:"domestic",data:[]},c=null!=a.getItem("iHisCity")?JSON.parse(a.getItem("iHisCity")):{type:"international",data:[]};var d=function(a){var b="demestic"==a.type?document.querySelector(".d-his-city-ele"):document.querySelector(".i-his-city-ele"),c=b.querySelector(".city-content"),d="";if(a.data.length>0){for(var e=0;e<a.data.length;e++)d+='<li class="city-content-item focus city-word">'+a.data[e]+"</li>";c.innerHTML=d,b.style.display="block"}};null!=b&&void 0!=b&&d(b),null!==c&&void 0!=c&&d(c)},historyChooseHandler:function(a,b){var c="domestic"==b?document.querySelector(".d-his-city-ele ul"):document.querySelector(".i-his-city-ele ul"),d="domestic"==b?document.querySelector(".d-his-city-ele"):document.querySelector(".i-his-city-ele"),e="",f=[],g=window.localStorage,h=null,i=null;h=null!=g.getItem("dHisCity")?JSON.parse(g.getItem("dHisCity")):{type:"domestic",data:[]},i=null!=g.getItem("iHisCity")?JSON.parse(g.getItem("iHisCity")):{type:"international",data:[]},Array.prototype.distinct=function(){for(var a=function(b,c){var d=!0;if(!b||!c)return!1;for(var e in b){if(!c[e])return!1;if("object"==typeof b[e])d=a(b[e],c[e]);else if(b[e]!==c[e])return!1}return d},b=[],c={},d=0,e=this.length;e>d;d++)a(c[typeof this[d]+this[d]],this[d])||(b.push(this[d]),c[typeof this[d]+this[d]]=this[d]);return b},"domestic"==b?(void 0==h?f.unshift(a):(f=h.data,f.unshift(a),f=f.distinct(),f=f.length>3?f.slice(0,3):f),g.setItem("dHisCity",JSON.stringify({type:"demestic",data:f}))):(void 0==i?f.unshift(a):(f=i.data,f.unshift(a),f=f.distinct(),f=f.length>3?f.slice(0,3):f),g.setItem("iHisCity",JSON.stringify({type:"international",data:f})));for(var j=0;j<f.length;j++)e+='<li class="city-content-item focus city-word">'+f[j]+"</li>";c.innerHTML=e,d.style.display="block"},checkLocation:function(a){for(var b=0,c=domesticCities.length;c>b;b++)for(var d in domesticCities[b])if(domesticCities[b][d]==a)return"domestic";for(var e=0,f=internationalCities.length;f>e;e++)for(var g in internationalCities[e])if(internationalCities[e][g]==a)return"international"},eventHandle2:function(){var a=ticketIndexModal,b=document.querySelector(".city-list-choose"),c=document.querySelector("#city-input-zone"),d=document.querySelector(".cur-word"),e=document.querySelector(".c-htab"),f=document.querySelector(".domestic-city"),g=document.querySelector(".international-city"),h=document.querySelector(".city-list-searched"),i=document.querySelector(".air_content"),j=(document.querySelectorAll(".cabin-wrap"),document.querySelector(".mask"),document.querySelector(".clearfix"));f.style.display="block",g.style.display="none",this.addHandler(i,"click",function(a){var b,c,d,e,f,g,a=a||window.event,h=a.target||a.srcElement,i=this,j=document.querySelector("#show-result-tip");if(h.className.indexOf("add-minus-per-more adult")>-1){b=h.parentNode.parentNode.parentNode,c=h.parentNode.parentNode,e=h.parentNode.querySelector(".add-minus-per-less"),d=h.parentNode.querySelector(".add-minus-per-content.adult-number");var k=parseInt(d.innerHTML),l=parseInt(b.querySelectorAll("li")[1].querySelector(".add-minus-per-content.child-number").innerHTML);g=b.querySelectorAll("li")[1].querySelector(".add-minus-per-more.child"),k+1+l>9?(h.className="add-minus-per-more adult add-minus-per-more-grey",j.innerHTML="乘客总数不能超过 9 人!",j.style.display="block",i.timer9=window.setTimeout(function(){j.style.display="none",window.clearTimeout(i.timer9),i.timer9=null},3e3),e.className="add-minus-per-less adult"):0!=l&&.5>(k+1)/l?(j.innerHTML="1 位成人最多携带 2 名儿童!!",j.style.display="block",i.timer10=window.setTimeout(function(){j.style.display="none",window.clearTimeout(i.timer10),i.timer10=null},3e3),alert("")):(k++,d.innerHTML=k,h.className=k+l>=9?"add-minus-per-more adult add-minus-per-more-grey":"add-minus-per-more adult",g.className=k+l>=9?"add-minus-per-more child add-minus-per-more-grey":"add-minus-per-more child",e.className="add-minus-per-less adult")}else if(h.className.indexOf("add-minus-per-less adult")>-1){b=h.parentNode.parentNode.parentNode,c=h.parentNode.parentNode,e=h.parentNode.querySelector(".add-minus-per-more"),d=h.parentNode.querySelector(".add-minus-per-content.adult-number"),f=b.querySelectorAll("li")[1].querySelector(".add-minus-per-content.child-number"),g=b.querySelectorAll("li")[1].querySelector(".add-minus-per-more.child");var k=parseInt(d.innerHTML),l=parseInt(f.innerHTML);1>=k?(d.innerHTML=1,h.className="add-minus-per-less adult add-minus-per-less-grey",e.className="add-minus-per-more adult"):(k--,d.innerHTML=k,h.className=2>k?"add-minus-per-less adult add-minus-per-less-grey":"add-minus-per-less adult",0!=l&&.5>k/l&&(f.innerHTML=2*k,g.className="add-minus-per-more child add-minus-per-more-grey"),e.className="add-minus-per-more adult")}else if(h.className.indexOf("add-minus-per-more child")>-1){b=h.parentNode.parentNode.parentNode,c=h.parentNode.parentNode,e=h.parentNode.querySelector(".add-minus-per-less"),d=h.parentNode.querySelector(".add-minus-per-content.child-number");var l=parseInt(d.innerHTML),m=b.querySelectorAll("li")[0].querySelector(".add-minus-per-more.adult"),k=parseInt(b.querySelectorAll("li")[0].querySelector(".add-minus-per-content.adult-number").innerHTML);k+1+l>9?(h.className="add-minus-per-more child add-minus-per-more-grey",j.innerHTML="乘客总数不能超过 9 人!",j.style.display="block",i.timer11=window.setTimeout(function(){j.style.display="none",window.clearTimeout(i.timer11),i.timer11=null},3e3),e.className="add-minus-per-less child"):0!=l&&.5>k/(l+1)?(j.innerHTML="1 位成人最多携带 2 名儿童!",j.style.display="block",i.timer13=window.setTimeout(function(){j.style.display="none",window.clearTimeout(i.timer13),i.timer13=null},3e3),h.className="add-minus-per-more child add-minus-per-more-grey"):(l++,d.innerHTML=l,h.className=.5>=k/l?"add-minus-per-more child add-minus-per-more-grey":"add-minus-per-more child",m.className=k+l>=9?"add-minus-per-more adult add-minus-per-more-grey":"add-minus-per-more adult",e.className="add-minus-per-less child")}else if(h.className.indexOf("add-minus-per-less child")>-1){b=h.parentNode.parentNode.parentNode,c=h.parentNode.parentNode,e=h.parentNode.querySelector(".add-minus-per-more"),d=h.parentNode.querySelector(".add-minus-per-content.child-number");var l=parseInt(d.innerHTML),k=parseInt(b.querySelectorAll("li")[0].querySelector(".add-minus-per-content.adult-number").innerHTML),n=b.querySelector(".add-minus-per-more.adult");0>=l-1?(d.innerHTML=0,h.className="add-minus-per-less child add-minus-per-less-grey",e.className="add-minus-per-more child"):0!=l&&.5>k/(l-1)?(j.innerHTML="1 位成人最多携带 2 名儿童!",j.style.display="block",i.timer12=window.setTimeout(function(){j.style.display="none",window.clearTimeout(i.timer12),i.timer12=null},3e3)):(d.innerHTML=l-1,e.className="add-minus-per-more child",n.className="add-minus-per-more adult")}}),this.addHandler(h,"click",function(d){for(var e,f,d=d||window.event,g=d.target||d.srcElement,h=g;"LI"!=h.tagName&&"SPAN"==g.tagName;)h=h.parentNode;if(e=h.querySelector(".result-city-name"),null!=e.querySelector(".high-light-letter")){var i=/([\u4e00-\u9fa5]*)<.*>([\u4e00-\u9fa5]{1,})<.*>([\u4e00-\u9fa5]*)/g,j=i.exec(e.innerHTML);f=j[1]+j[2]+j[3]}else f=e.innerHTML;a.historyChooseHandler(f,a.checkLocation(f)),c.value=f,a.timer3=window.setTimeout(function(){b.style.display="none",document.querySelector(".air_content").style.display="block",a.celement.innerHTML=c.value,window.clearTimeout(a.timer3),a.timer3=null},1e3)}),this.addHandler(e,"click",function(a){var a=a||window.event,b=a.target||a.srcElement,c=document.getElementById("city-input-zone");if("domestic-top-line"==b.className){c.placeholder="北京/beijing/bj/bjs/中国",b.className="domestic-top-line addFontStyle",b.parentNode.querySelector(".international-top-line").className="international-top-line",f.style.display="block",g.style.display="none";var d=document.querySelector(".right-side");d.innerHTML='<div class="cur-word"><div class="special-tip"><span class="cur-city"><a href="#CURR">当前</a></span><span class="his-city"><a href="#HIST">历史</a></span><span class="re-hot-city"><a href="#HOTT">热门</a></span></div><div class="city-pin-fir"><div><a class="letter" href="#A">A</a><a class="letter" href="#B">B</a><a class="letter" href="#C">C</a><a class="letter" href="#D">D</a><a class="letter" href="#E">E</a><a class="letter" href="#F">F</a><a class="letter" href="#G">G</a><a class="letter" href="#H">H</a><a class="letter" href="#I">I</a><a class="letter" href="#J">J</a><a class="letter" href="#K">K</a><a class="letter" href="#L">L</a><a class="letter" href="#M">M</a><a class="letter" href="#N">N</a><a class="letter" href="#O">O</a><a class="letter" href="#P">P</a><a class="letter" href="#Q">Q</a><a class="letter" href="#R">R</a><a class="letter" href="#S">S</a><a class="letter" href="#T">T</a><a class="letter" href="#U">U</a><a class="letter" href="#V">V</a><a class="letter" href="#W">W</a><a class="letter" href="#X">X</a><a class="letter" href="#Y">Y</a><a class="letter" href="#Z">Z</a></div></div></div></div>'}else if("international-top-line"==b.className){c.placeholder="新加坡/xinjiapo/xjp/sin",b.className="international-top-line addFontStyle",f.style.display="none",b.parentNode.querySelector(".domestic-top-line").className="domestic-top-line",g.style.display="block";var d=document.querySelector(".right-side");d.innerHTML='<div class="cur-word"><div class="special-tip"><span class="cur-city"><a href="#ICURR">当前</a></span><span class="his-city"><a href="#IHIST">历史</a></span><span class="re-hot-city"><a href="#IHOTT">热门</a></span></div><div class="city-pin-fir"><div><a class="letter" href="#INA">A</a><a class="letter" href="#INB">B</a><a class="letter" href="#INC">C</a><a class="letter" href="#IND">D</a><a class="letter" href="#INE">E</a><a class="letter" href="#INF">F</a><a class="letter" href="#ING">G</a><a class="letter" href="#INH">H</a><a class="letter" href="#INI">I</a><a class="letter" href="#INJ">J</a><a class="letter" href="#INK">K</a><a class="letter" href="#INL">L</a><a class="letter" href="#INM">M</a><a class="letter" href="#INN">N</a><a class="letter" href="#INO">O</a><a class="letter" href="#INP">P</a><a class="letter" href="#INQ">Q</a><a class="letter" href="#INR">R</a><a class="letter" href="#INS">S</a><a class="letter" href="#INT">T</a><a class="letter" href="#INU">U</a><a class="letter" href="#INV">V</a><a class="letter" href="#INW">W</a><a class="letter" href="#INX">X</a><a class="letter" href="#INY">Y</a><a class="letter" href="#INZ">Z</a></div></div></div></div>'}}),this.addHandler(j,"click",function(a){var a=a||window.event,b=a.target||a.srcElement;"fl"==b.className&&window.history.go(-1)}),this.addHandler(d,"click",function(a){var a=a||window.event,b=a.target||a.srcElement;"block"==f.style.display&&"none"==g.style.display?"SPAN"==b.tagName&&b.className.indexOf("letter")>-1&&document.querySelector(".d"+b.innerHTML+"-Link")?document.querySelector(".d"+b.innerHTML+"-Link").scrollIntoView(!0):"SPAN"==b.tagName&&b.className.indexOf("city")>-1&&document.querySelector(".d-"+b.className).scrollIntoView(!0):"none"==f.style.display&&"block"==g.style.display&&("SPAN"==b.tagName&&b.className.indexOf("letter")>-1&&document.querySelector(".i"+b.innerHTML+"-Link")?document.querySelector(".i"+b.innerHTML+"-Link").scrollIntoView(!0):"SPAN"==b.tagName&&b.className.indexOf("city")>-1&&document.querySelector(".i-"+b.className).scrollIntoView(!0))}),c.addEventListener?(c.addEventListener("focus",function(){var a=$('<div class="city-choose-mask"></div>');a.appendTo($(".city-content"))},!1),c.addEventListener("blur",function(){$(".city-choose-mask").remove()},!1),c.addEventListener("input",a.searchHandler,!1)):c.attachEvent("onpropertychange",a.searchHandler),this.addHandler(b,"click",function(d){var d=d||window.event,e=d.target||d.srcElement;"fl"==e.className?(b.style.display="none",document.querySelector(".air_content").style.display="block"):-1!=e.className.indexOf("city-word")&&("block"==f.style.display?a.historyChooseHandler(e.innerHTML,"domestic"):a.historyChooseHandler(e.innerHTML,"international"),c.value=e.innerHTML,a.timer2=window.setTimeout(function(){b.style.display="none",document.querySelector(".air_content").style.display="block",a.celement.innerHTML=e.innerHTML,window.clearTimeout(a.timer2),a.timer2=null},1e3))})},searchHandler:function(){var a=document.querySelector(".city-list-searched"),b=document.querySelector("#city-input-zone"),c=(document.querySelector(".domestic-city"),document.querySelector(".international-city"),b.value),d="",e=/[A-Za-z]{2,}|[\u4e00-\u9fa5]{1,}/;Array.prototype.distinct=function(){for(var a=function(b,c){var d=!0;if(!b||!c)return!1;for(var e in b){if(!c[e])return!1;if("object"==typeof b[e])d=a(b[e],c[e]);else if(b[e]!==c[e])return!1}return d},b=[],c={},d=0,e=this.length;e>d;d++)a(c[typeof this[d]+this[d]],this[d])||(b.push(this[d]),c[typeof this[d]+this[d]]=this[d]);return b};var f=[],g=[];if(e.test(c)){g=domesticCities.concat(internationalCities);for(var h=0;h<g.length;h++)for(var i in g[h])/[\u4e00-\u9fa5]{1,}/.test(g[h][i])?g[h].cityNameCN.indexOf(c)>-1&&f.push(g[h]):g[h][i].toLowerCase().indexOf(c.toLowerCase())>-1&&f.push(g[h]);if(f=f.distinct(),f.length)for(var j=0;j<f.length;j++){var k="",l="",m="",n="";/[A-Za-z]+/.test(c)?f[j].pingYin.toUpperCase().indexOf(c.toUpperCase())>-1?(k=f[j].pingYin,l=k.substring(0,k.toUpperCase().indexOf(c.toUpperCase())),m=k.substr(k.toUpperCase().indexOf(c.toUpperCase()),c.length),n=k.substr(k.toUpperCase().indexOf(c.toUpperCase())+c.length),d+='<li class="city-list-searched-item"><span class="result-city-name">'+f[j].cityNameCN+'</span><span class="result-city-name-letter">'+l+'<span class="high-light-letter">'+m+"</span>"+n+"</span></li>"):f[j].cityNameEn.toUpperCase().indexOf(c.toUpperCase())>-1?(k=f[j].cityNameEn,l=k.substring(0,k.toUpperCase().indexOf(c.toUpperCase())),m=k.substr(k.toUpperCase().indexOf(c.toUpperCase()),c.length),n=k.substr(k.toUpperCase().indexOf(c.toUpperCase())+c.length),d+='<li class="city-list-searched-item"><span class="result-city-name">'+f[j].cityNameCN+'</span><span class="result-city-name-letter">'+l+'<span class="high-light-letter">'+m+"</span>"+n+"</span></li>"):f[j].cityCode.toUpperCase().indexOf(c.toUpperCase())>-1?d+='<li class="city-list-searched-item"><span class="result-city-name">'+f[j].cityNameCN+'</span><span class="result-city-name-letter">'+f[j].pingYin+"</span></li>":f[j].hyKeyWord.toUpperCase().indexOf(c.toUpperCase())>-1?d+='<li class="city-list-searched-item"><span class="result-city-name">'+f[j].cityNameCN+'</span><span class="result-city-name-letter">'+f[j].pingYin+"</span></li>":f[j].countryName.toUpperCase().indexOf(c.toUpperCase())>-1&&(d+='<li class="city-list-searched-item"><span class="result-city-name">'+f[j].cityNameCN+'</span><span class="result-city-name-letter">'+f[j].pingYin+"</span></li>"):/[\u4E00-\u9FA5]/.test(c)&&(k=f[j].cityNameCN,l=k.substring(0,k.indexOf(c)),m=k.substr(k.indexOf(c),k.indexOf(c)+c.length),n=k.substr(k.indexOf(c)+c.length),d+='<li class="city-list-searched-item"><span class="result-city-name chinese-city-name-fix">'+l+'<span class="high-light-letter">'+m+"</span>"+n+'</span><span class="result-city-name-letter chinese-city-spellname-fix">'+f[j].pingYin+"</span></li>")}else d+='<li class="city-list-searched-item">该城市无机场</li>';a.innerHTML=d,a.style.display="block"}else a.style.display="none"},initDate:function(){var a,b,c=new Date,d=new Date(c.setDate(c.getDate()+1)),e=new Date(c.setDate(c.getDate()+2)),f="",g="",h="",i="",j=function(a){var b="";switch(a){case 0:b="周日";break;case 1:b="周一";break;case 2:b="周二";break;case 3:b="周三";break;case 4:b="周四";break;case 5:b="周五";break;case 6:b="周六"}return b};f=parseInt(d.getMonth()+1)>=10?parseInt(d.getMonth()+1):"0"+parseInt(d.getMonth()+1),g=parseInt(d.getDate())>=10?parseInt(d.getDate()):"0"+parseInt(d.getDate()),h=parseInt(e.getMonth()+1)>=10?parseInt(e.getMonth()+1):"0"+parseInt(e.getMonth()+1),i=parseInt(e.getDate())>=10?parseInt(e.getDate()):"0"+parseInt(e.getDate()),a=[f+"月"+g+"日",j(d.getDay())],b=[h+"月"+i+"日",j(e.getDay())],document.querySelector(".single-date").innerHTML=a[0],document.querySelector(".single-week").innerHTML=a[1],document.querySelector(".double-date-one").innerHTML=a[0],document.querySelector(".double-week-one").innerHTML=a[1],document.querySelector(".double-date-two").innerHTML=b[0],document.querySelector(".double-week-two").innerHTML=b[1]},initShowData:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,a=a,p=new Date,q=new Date(p.setDate(p.getDate()+1)),r=new Date(p.setDate(p.getDate()+2)),s=document.querySelector(".singleTrip"),t=document.querySelector(".doubleTrip"),u=function(a){var b,c,d=/\d{4}-(\d{2})-(\d{2})/,e=new Date(a.replace(/-/g,"/")).getDay();switch(c=d.exec(a),e){case 0:b="周日";break;case 1:b="周一";break;case 2:b="周二";break;case 3:b="周三";break;case 4:b="周四";break;case 5:b="周五";break;case 6:b="周六"}return{date:c[1]+"月"+c[2]+"日",weekWord:b}},v=function(a){var b="";switch(a){case"Economy":b="经济舱";break;case"Business":b="商务舱";break;case"First":b="头等舱";break;case"EconomyPremium":b="豪华经济舱"}return b};if(new Date(a.DepartDate.replace(/-/g,"/"))<q){var w=q.getMonth()+1<10?"0"+(q.getMonth()+1):q.getMonth()+1,x=q.getDate()<10?"0"+q.getDate():q.getDate(),y=r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1,z=r.getDate()<10?"0"+r.getDate():r.getDate(),A=q.getFullYear();
"Return"==a.RouteType&&(a.ReturnDate=A+"-"+y+"-"+z),a.DepartDate=A+"-"+w+"-"+x}"Oneway"==a.RouteType?(b=document.querySelector("#single"),c=document.querySelector("#double"),s.className="singleTrip light-title",t.className="doubleTrip grey-title",e=b.querySelector(".single-date"),f=b.querySelector(".single-week"),g=b.querySelector(".add-minus-per-content.adult-number"),h=b.querySelector(".add-minus-per-content.child-number"),i=c.querySelector(".add-minus-per-content.adult-number"),j=c.querySelector(".add-minus-per-content.child-number"),k=b.querySelector(".cabin-wrap-choice.single-cabin-choose"),e.innerHTML=u(a.DepartDate).date,f.innerHTML=u(a.DepartDate).weekWord):"Return"==a.RouteType&&(b=document.querySelector("#double"),c=document.querySelector("#single"),s.className="singleTrip grey-title",t.className="doubleTrip light-title",l=b.querySelector(".double-date-one"),m=b.querySelector(".double-week-one"),n=b.querySelector(".double-date-two"),o=b.querySelector(".double-week-two"),g=b.querySelector(".add-minus-per-content.adult-number"),h=b.querySelector(".add-minus-per-content.child-number"),k=b.querySelector(".cabin-wrap-choice.double-cabin-choose"),i=c.querySelector(".add-minus-per-content.adult-number"),j=c.querySelector(".add-minus-per-content.child-number"),l.innerHTML=u(a.DepartDate).date,m.innerHTML=u(a.DepartDate).weekWord,n.innerHTML=u(a.ReturnDate).date,o.innerHTML=u(a.ReturnDate).weekWord),d=document.querySelectorAll(".city-search"),b.style.display="block",c.style.display="none",d[0].innerHTML=a.fromCity,d[1].innerHTML=a.toCity,g.innerHTML=a.NumofAdult,h.innerHTML=a.NumofChild,g.parentNode.querySelector(".add-minus-per-less.adult").className=parseInt(a.NumofAdult)<2?"add-minus-per-less adult add-minus-per-less-grey":"add-minus-per-less adult",h.parentNode.querySelector(".add-minus-per-less.child").className=parseInt(a.NumofChild)<1?"add-minus-per-less child add-minus-per-less-grey":"add-minus-per-less child",i.parentNode.querySelector(".add-minus-per-less.adult").className=parseInt(a.NumofAdult)<2?"add-minus-per-less adult add-minus-per-less-grey":"add-minus-per-less adult",j.parentNode.querySelector(".add-minus-per-less.child").className=parseInt(a.NumofChild)<1?"add-minus-per-less child add-minus-per-less-grey":"add-minus-per-less child",k.innerHTML=v(a.CabinClass)},loadingFade:function(){$(window).load(function(){$("#status-f").fadeOut(),$("#preloader").delay(400).fadeOut("medium")})},init:function(){this.ticketSearchedInfo=this.storageUtil.get("ticketSearchedInfo")||"",this.initDate(),this.ticketSearchedInfo&&this.initShowData(this.ticketSearchedInfo),this.loadingFade(),this.getHotCity("NOTCN"),this.getHotCity("CN"),this.createWrap(),this.addContent(),this.createHisCity(),this["double"](),this.single(),this.eventHandle2(),this.singleAndDoubleTangle(),this.toTicketList(),this.toCitySearch(),this.tangleCity()}};ticketIndexModal.init();