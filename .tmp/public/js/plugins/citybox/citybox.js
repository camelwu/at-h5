/*! asiatravel FE team at-h5-nodejs-----2016-05-19T16:09:38 */
!function(){var a=this||(0,eval)("this"),b=0,c=0,d=44,e="",f="",g={HistoryData:{},HotCityListData:{},CityListData:{},LetterIndexData:[]},h=function(a,b){return a.fullSpellingName.replace(/(^\s*)|(\s*$)/g,"").substr(0,1).toLowerCase().charCodeAt(0)-b.fullSpellingName.replace(/(^\s*)|(\s*$)/g,"").substr(0,1).toLowerCase().charCodeAt(0)},i=function(){var a={hft_ori:function(){var a={Parameters:{},ForeEndType:3,Code:"60100014"},b={Parameters:{},ForeEndType:3,Code:"60100001"};vlm.loadJson("",JSON.stringify(a),k.hftOriHotCityListDataCallback),vlm.loadJson("",JSON.stringify(b),k.hftOriCityListDataCallback)},hft_des:function(){var a={Parameters:{},ForeEndType:3,Code:"60100014"},b={Parameters:{},ForeEndType:3,Code:"60100001"};vlm.loadJson("",JSON.stringify(a),k.hftDesHotCityListDataCallback),vlm.loadJson("",JSON.stringify(b),k.hftDesCityListDataCallback)},hf_ori:function(){var a={Parameters:{},ForeEndType:3,Code:"50100010"},b={Parameters:{CityType:"1",LastTime:"2016-04-15"},ForeEndType:3,Code:"50100008"};vlm.loadJson("",JSON.stringify(a),k.hfOriHotCityListDataCallback),vlm.loadJson("",JSON.stringify(b),k.hfOriCityListDataCallback)},hf_des:function(){var a={Parameters:{},ForeEndType:3,Code:"50100010"},b={Parameters:{CityType:"2",LastTime:"2016-04-15"},ForeEndType:3,Code:"50100008"};vlm.loadJson("",JSON.stringify(a),k.hfDesHotCityListDataCallback),vlm.loadJson("",JSON.stringify(b),k.hfDesCityListDataCallback)}};return{callAjaxAdapter:function(b,c){return a[b]?a[b](c):""},addAjaxAdapter:function(b,c){a[b]=c}}},j=function(){var a={hftHotCity:function(a){for(var b={},c=[],d=0;d<a.length;d++)b={cityCode:a[d].cityCode,cityName:a[d].cityName,countryCode:a[d].countryCode,countryName:a[d].countryName,fullSpellingName:a[d].fullSpellingName},c.push(b);return c},hftCityList:function(a){for(var b={},c=[],d=0;d<a.length;d++)b={cityCode:a[d].cityCode,cityName:a[d].cityName,countryCode:a[d].countryCode,countryName:a[d].countryName,fullSpellingName:a[d].fullSpellingName},c.push(b);return c},hfHotCity:function(a){for(var b={},c=[],d=0;d<a.length;d++)b={cityCode:a[d].cityCode,cityName:a[d].cityName,countryCode:a[d].countryCode,countryName:a[d].countryName,fullSpellingName:a[d].fullSpellingName},c.push(b);return c},hfCityList:function(a){for(var b={},c=[],d=0;d<a.length;d++)b={cityCode:a[d].cityCode,cityName:a[d].cityName,countryCode:a[d].countryCode,countryName:a[d].countryName,fullSpellingName:a[d].fullSpellingName},c.push(b);return c}};return{callAdapter:function(b,c){return a[b]?a[b](c):""},addAdapter:function(b,c){a[b]=c}}},k={showCityBox:function(){$(".citybox_search_container.citybox_search_state .citybox_content,.js_citybox_header_default").css("display","block"),$(".citybox_search_container.citybox_search_state .citybox_search_suggest,.js_citybox_header_search").css("display","none")},hideCityBox:function(){$(".citybox_search_container.citybox_search_state .citybox_content,.js_citybox_header_default").css("display","none"),$(".citybox_search_container.citybox_search_state .citybox_search_suggest,.js_citybox_header_search").css("display","block"),l("citybox_suggest_list")},hideAllCityBox:function(){$(".citybox_search_container.citybox_search_state .citybox_content,.js_citybox_header_default").css("display","none"),$(".citybox_search_container.citybox_search_state .citybox_search_suggest,.js_citybox_header_search").css("display","none")},loadingCityBox:function(){b&&c&&$("#preloader").hide()},setCityBox:function(a,d){e=d.data,f=d.returnId,b=0,c=0,$("#preloader").show(),k.showCityBox(),l("citybox_history"),i().callAjaxAdapter(e)},hftOriHotCityListDataCallback:function(a){a.success&&(g.HotCityListData=j().callAdapter("hftHotCity",a.data.hotCitysCN),l("citybox_hotcitylist"),b=1,k.loadingCityBox())},hftDesHotCityListDataCallback:function(a){a.success&&(g.HotCityListData=j().callAdapter("hftHotCity",a.data.hotCitysInternational),l("citybox_hotcitylist"),b=1,k.loadingCityBox())},hftOriCityListDataCallback:function(a){a.success&&(g.CityListData=j().callAdapter("hftCityList",a.data.departCities),l("citybox_citylist"),c=1,k.loadingCityBox())},hftDesCityListDataCallback:function(a){a.success&&(g.CityListData=j().callAdapter("hftCityList",a.data.destCities),l("citybox_citylist"),c=1,k.loadingCityBox())},hfOriHotCityListDataCallback:function(a){a.success&&(g.HotCityListData=j().callAdapter("hfHotCity",a.data.hotCitysCN),l("citybox_hotcitylist"),b=1,k.loadingCityBox())},hfDesHotCityListDataCallback:function(a){a.success&&(g.HotCityListData=j().callAdapter("hfHotCity",a.data.hotCitysInternational),l("citybox_hotcitylist"),b=1,k.loadingCityBox())},hfOriCityListDataCallback:function(a){a.success&&(g.CityListData=j().callAdapter("hfCityList",a.data.citys),l("citybox_citylist"),c=1,k.loadingCityBox())},hfDesCityListDataCallback:function(a){a.success&&(g.CityListData=j().callAdapter("hfCityList",a.data.citys),l("citybox_citylist"),c=1,k.loadingCityBox())},cityboxHeader:function(a,b){},cityboxLocation:function(a,b){a.innerHTML="";var c=document.createElement("div");c.setAttribute("class","citybox_content_title"),c.setAttribute("id","js_location"),c.innerHTML="当前",a.appendChild(c);var d=document.createElement("div");d.setAttribute("class","citybox_content_itemtitle"),d.innerHTML="北京";var e=document.createElement("li");e.setAttribute("class","citybox_content_item selected"),e.setAttribute("data-code","200"),e.setAttribute("data-name","北京"),e.setAttribute("data-letter","bj"),e.appendChild(d);var f=document.createElement("ul");f.setAttribute("class","citybox_content_container"),f.appendChild(e),a.appendChild(f)},cityboxSearchSuggest:function(a,b){a.innerHTML="",$("#js_citybox_searchactive_input").val(""),$("#js_citybox_searchactive_input").bind("keyup , input propertychange",function(){var b=g.CityListData,c=$("#js_citybox_searchactive_input").val();if(a.innerHTML="",""!=c){c=c.replace(/\s+/g,""),c=c.toLowerCase();for(var d=document.createDocumentFragment(),e=0;e<b.length;e++){var h=b[e].cityCode.toLowerCase(),i=b[e].cityName.toLowerCase(),j=b[e].countryCode.toLowerCase(),l=b[e].countryName.toLowerCase(),m=b[e].fullSpellingName.toLowerCase(),n=h+i+j+l+m;if(n.indexOf(c)>-1){var o=document.createElement("li");o.setAttribute("class","thin_border");var p=document.createElement("span");p.setAttribute("class","citybox_searchactive_li_icon"),o.appendChild(p);var q=document.createElement("p");q.setAttribute("class","citybox_searchactive_li_p"),q.setAttribute("data-code",b[e].cityCode),q.setAttribute("data-name",b[e].cityName),q.setAttribute("data-letter",b[e].fullSpellingName),q.innerHTML=b[e].cityName,q.onclick=function(){var a=this.getAttribute("data-name"),b=this.getAttribute("data-code");$(f).attr("data-code",b),$(f).html(a),k.hideAllCityBox()},o.appendChild(q),d.appendChild(o)}}a.appendChild(d)}})},cityboxHistory:function(a,b){a.innerHTML="";var c=localStorage.getItem(""+e+"_history");c=JSON.parse(c);var d=document.createElement("div");if(d.setAttribute("class","citybox_content_title"),d.setAttribute("id","js_history"),d.innerHTML="历史选择",a.appendChild(d),c){var g=document.createElement("ul");g.setAttribute("class","citybox_content_container");for(var h=c.length-1;h>=0;h--){var i=document.createElement("li");i.setAttribute("class","citybox_content_item"),i.setAttribute("data-code",c[h].toString().split(":")[0]),i.setAttribute("data-name",c[h].toString().split(":")[1]),i.onclick=function(){var a=this.getAttribute("data-name"),b=this.getAttribute("data-code");$(f).attr("data-code",b),$(f).html(a),k.setcityboxHistory(this,b,a),k.hideAllCityBox()};var j=document.createElement("div");j.setAttribute("class","citybox_content_itemtitle"),j.innerHTML=c[h].toString().split(":")[1],i.appendChild(j),g.appendChild(i)}a.appendChild(g)}},setcityboxHistory:function(a,b,c){var d=[],f=[b+":"+c],g=localStorage.getItem(""+e+"_history");if(g){g=JSON.parse(g);for(var h=g.length-1;h>=0;h--)if(g[h].toString().split(":")[0]===b)return d=g[h],k.remove(g,h),g.push(d),d=g,void localStorage.setItem(""+e+"_history",JSON.stringify(d));g.length>2&&g.shift(),g.push(f),d=g,localStorage.setItem(""+e+"_history",JSON.stringify(d))}else d.push(f),localStorage.setItem(""+e+"_history",JSON.stringify(d))},remove:function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=0>b?a.length+b:b,a.push.apply(a,d)},cityboxHotCityList:function(a,b){a.innerHTML="";var b=b.data,c=document.createElement("div");c.setAttribute("class","citybox_content_title"),c.setAttribute("id","js_hotcity"),c.innerHTML="热门城市",a.appendChild(c);var d=document.createElement("ul");d.setAttribute("class","citybox_content_container"),a.appendChild(d);for(var e=0;e<b.length;e++){var g=document.createElement("li");g.setAttribute("class","citybox_content_item"),g.setAttribute("data-code",b[e].cityCode),g.setAttribute("data-name",b[e].cityName),g.setAttribute("data-letter",b[e].fullSpellingName),g.onclick=function(){var a=this.getAttribute("data-name"),b=this.getAttribute("data-code");$(f).attr("data-code",b),$(f).html(a),k.setcityboxHistory(this,b,a),k.hideAllCityBox()};var h=document.createElement("div");h.setAttribute("class","citybox_content_itemtitle"),h.innerHTML=b[e].cityName,g.appendChild(h),d.appendChild(g)}},cityboxCityList:function(a,b){a.innerHTML="";var b=b.data.sort(h),c="",d="";g.LetterIndexData=[];for(var e=document.createDocumentFragment(),i=0;i<b.length;i++){if(c=b[i].fullSpellingName.replace(/(^\s*)|(\s*$)/g,"").substr(0,1).toUpperCase(),c!=d){g.LetterIndexData.push(c);var j=document.createElement("div");j.setAttribute("class","citybox_content_title"),j.setAttribute("id","js_index_"+c),j.innerHTML=c,e.appendChild(j);var m=document.createElement("ul");m.setAttribute("class","citybox_content_lettercitylist"),e.appendChild(m)}var n=document.createElement("li");n.setAttribute("class","citybox_content_lettername"),n.setAttribute("data-code",b[i].cityCode),n.setAttribute("data-name",b[i].cityName),n.setAttribute("data-letter",b[i].fullSpellingName),n.innerHTML=b[i].cityName,n.onclick=function(){var a=this.getAttribute("data-name"),b=this.getAttribute("data-code");$(f).attr("data-code",b),$(f).html(a),k.setcityboxHistory(this,b,a),k.hideAllCityBox()},m.appendChild(n),e.appendChild(m),a.appendChild(e),d=c}l("citybox_letterindex")},cityboxLetterIndex:function(a,b){a.innerHTML="";var b=b.data,c=document.createElement("li");c.setAttribute("class","citybox_summary_item"),c.setAttribute("data-key","location"),c.innerHTML="当前",c.onclick=function(){var a=this.getAttribute("data-key"),b=$("#js_"+a);0!=b.length&&(h=b.offset().top-d),$(window).scrollTop(h)},a.appendChild(c);var e=document.createElement("li");e.setAttribute("class","citybox_summary_item"),e.setAttribute("data-key","history"),e.innerHTML="历史",e.onclick=function(){var a=this.getAttribute("data-key"),b=$("#js_"+a);0!=b.length&&(h=b.offset().top-d),$(window).scrollTop(h)},a.appendChild(e);var f=document.createElement("li");f.setAttribute("class","citybox_summary_item"),f.setAttribute("data-key","hotcity"),f.innerHTML="热门",f.onclick=function(){var a=this.getAttribute("data-key"),b=$("#js_"+a);0!=b.length&&(h=b.offset().top-d),$(window).scrollTop(h)},a.appendChild(f);for(var g=document.createDocumentFragment(),h=0;h<b.length;h++){var i=document.createElement("li");i.setAttribute("class","citybox_summary_item"),i.setAttribute("data-key",b[h]),i.innerHTML=b[h],i.onclick=function(){var a=this.getAttribute("data-key"),b=$("#js_index_"+a);0!=b.length&&(h=b.offset().top-d),$(window).scrollTop(h)},g.appendChild(i)}a.appendChild(g)}},l=function(){function a(a){var b=a.getAttribute("data-bind");return!!b&&new Function("return ({"+b+"})")()}return function(b){var c=document.getElementById(b),d=null;d=a(c),d.type&&k[d.type]&&k[d.type](c,d)}}();a.VM=a.VM||{},a.VM.Load=l,a.VM.Method=k,a.VM.Config=g}();