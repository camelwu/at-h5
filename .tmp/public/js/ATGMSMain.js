/*! asiatravel FE team at-h5-nodejs-----2016-05-19T15:21:43 */
var at=function(){var a,b,c,d,e,f,g,h=[],i={attachTo:function(b){return a=document.getElementById(b),this},latitude:function(a){return b=a,this},longitude:function(a){return c=a,this},zoom:function(a){return d=Math.min(20,Math.max(1,a)),this},create:function(){return a?(e=new google.maps.Map(a,{zoom:d,center:new google.maps.LatLng(b,c),mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0}),h=[],e):"Error: Need to be attached to a dom node to render the map."},createMap:function(a,b,c){return null!=a&&null!=b?this.latitude(a).longitude(b).zoom(c||15).create():!1},currentMap:function(){return e},createMarker:function(a,b,c,d){if(!e)throw"Error: Need to create a map first!";var f=at.transform.wgs2gcj(a,b);a=f.lat,b=f.lng;var g=new google.maps.Marker({position:new google.maps.LatLng(a,b),map:e,icon:d});g.at_label=c,h.push(g);var i=this.infoWindow||(this.infoWindow=new google.maps.InfoWindow);return google.maps.event.addListener(g,"click",function(a){return function(){g.at_label&&(i.setContent(g.at_label),i.open(e,a))}}(g)),setTimeout(function(){google.maps.event.trigger(g,"click")},2e3),h.length},removeMarkerWithLabel:function(a){var b,c;return h.forEach(function(d,e){d.at_label==a&&(c=e,b=d)}),b?(b.setMap(null),h.splice(c,1),!0):!1},markHotel:function(a,b,c){return g={lat:a,lng:b},this.createMarker(a,b,c,at.icons.hotel)},markUser:function(a,b,c){return f={lat:a,lng:b},this.createMarker(a,b,c,at.icons.user)},moveCenter:function(a,d){b+=d/6378*(180/Math.PI),c+=a/6378*(180/Math.PI),this.currentMap()&&this.currentMap().panTo({lat:b,lng:c})},moveCenterToUserLocation:function(){return this.currentMap()&&(f&&f.lat&&f.lng?this.currentMap().panTo(at.transform.wgs2gcj(f.lat,f.lng)):this.locateCurrentPosition(function(){at.map.moveCenterToUserLocation()})),this},moveCenterToHotelLocation:function(){return this.currentMap()&&this.currentMap().panTo(at.transform.wgs2gcj(g.lat,g.lng)),this},locateCurrentPosition:function(a){var b=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(c){var d={lat:c.coords.latitude,lng:c.coords.longitude};f=d,a?a():(e.setCenter(at.transform.wgs2gcj(d.lat,d.lng)),b.markUser(d.lat,d.lng))},function(){alert("Get user location failed!")}):alert("Browser doesn't support geolocation!")}},j={};return{map:i,ocbridge:j}}(),initialize=function(){at.map.attachTo("map")};