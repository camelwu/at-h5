/*! asiatravel FE team at-h5-nodejs-----2016-05-19T15:21:43 */
function url2json(a){if(a){for(var b={},c=a.split("?"),d=c[1].split("&"),e=0;e<d.length;e++){var f=d[e].split("=");b[f[0]]=f[1]}return b}}var oldInfo=JSON.parse(localStorage.getItem("info")),newPara={StarRating:"",Location:"",SortType:1,PackageID:oldInfo.packageID,CheckinDate:oldInfo.CheckInDate,CheckoutDate:oldInfo.CheckOutDate,RoomDetails:oldInfo.roomDetails,Tours:oldInfo.tours},hotelList={CultureName:"zh-CN",requestUrl:"",eventHandler:function(a,b,c){return document.addEventListener?this.addHandler=function(a,b,c){a.addEventListener(b,c,!1)}:document.attachEvent?this.addHandler=function(a,b,c){a.attachEvent("on"+b,function(){c.call(a)})}:this.addHandler=function(a,b,c){a["on"+b]=c},this.addHandler(a,b,c),this},tAjax:function(a,b,c,d,e){var f=this,g={Parameters:b,ForeEndType:d,Code:c};return a=a?a:f.requestUrl,vlm.loadJson(a,JSON.stringify(g),e),this},callBack:function(a){var b=['<li class="ho_list" data-id="{%=hotelID%}">','<img class="h-choose" src="../images/ui/choose.png">','<div class="ho_pic">','<img src="../images/hotelDetailerrorpic.png" real-src="{%=hotelPictureURL%}" class="ho_img" />',"</div>",'<div class="ho_infor">','<p class="hname">{%=hotelName%}</p>','{% if(data["score"]||data["comments"]){ %}<div class="h-score">{% if(data["score"]){ %}<span style="color:#8ed1cc;font-size:1.5rem;font-weight: 600;">{%=score%}</span>{% } %} {% if(data["comments"]){ %}<span style="color:#999999;font-size:0.8rem;">分/{%=comments%}人点评</span>{% } %}</div> {% }else{ %}{% } %}','<div class="h-grade">','<span style="color:#999999;font-size:1rem;">{%=starRating%}星级</span>','{% if(data["freeWifi"]){ %}<b class="hl-icon1"></b>{% } %}','{% if(data["freeBus"]){ %}<b class="hl-icon2"></b>{% } %}','<p class="h-address">{%=location%}</p>',"</div>","</div>",'<div class="l-price">','<span style="font-size:0.8em;color:#fe4716;">{% if(currencyCode=="CNY"){ %}￥ {% }else{ %} $ {% } %}</span>','<span class="price-num">{%=avgRatePerPaxInCNY%}</span><span style="font-size:0.8em;color:#fe4716;">起/人</span>',"</div>","</li>"].join(""),c=['<li class="s-li1"> 不限 </li>',"{% for(var i=0;i < starRatingList.length;i++){ %}",'<li class="s-li">{%=starRatingList[i]%}</li>',"{% } %}"].join(""),d=['<li class="l-li">不限 <b class="l-icon1"></b></li>',"{% for(var i=0;i < locationList.length;i++){ %}",'<li class="l-li">{%=locationList[i]%}<b class="l-icon"></b></li>',"{% } %}"].join(""),e=a.data,f=hotelList;if(a.success)if(0==e.hotels.length)jAlert("抱歉暂时没有数据","提示");else{f.packageID=e.packageID,f.bookingFormInfo=e.bookingFormInfo;var g=e.hotels;g=f.resetData(g);var h=template(b,g),i=template(c,e),j=template(d,e);if($("#preloader").fadeOut(),$("#lsf_list").html(h),$("#h-level").html(i),$("#l-ul").html(j),""!=newPara.StarRating)for(var k=document.getElementById("h-level").getElementsByTagName("li"),l=newPara.StarRating.split("$"),m=0;m<k.length;m++)for(var n=0;n<l.length-1;n++)k[m].innerHTML==l[n]&&(k[0].className="s-li",k[m].className="s-li1");var o=newPara.Location.replace("$","");o=o?o:"不限",$("#l-ul .l-li").find("b").removeClass("l-icon1").addClass("l-icon"),$("#l-ul .l-li").each(function(a,b){var c=$(b);return c.text().trim()===o?void c.find("b").addClass("l-icon1").removeClass("l-icon"):void 0}),f.delayLoadImage().addEvent()}else jAlert(a.message,"提示")},resetData:function(){for(var a=arguments[0],b=function(a){var b="";switch(a[0]){case"0":b="";break;case"1":b="一";break;case"2":b="二";break;case"3":b="三";break;case"4":b="四";break;case"5":b="五";break;case"6":b="六";break;default:b=""}return b},c=0,d=arguments[0].length;d>c;c++){var e=arguments[0][c].starRating;a[c].starRating=b(e)}return a},addEvent:function(){var a=document.querySelector("#lsf_list"),b=this,c=a.querySelectorAll(".h-choose");return b.eventHandler(a,"click",function(a){for(var d,e=a||window.event,f=e.target||e.srcElement,g=f,h=0;h<c.length;h++)c[h].style.display="none";for(;"ho_list"!=g.className;)g=g.parentNode;d=g.querySelector(".h-choose"),d.style.display="block"==d.style.display?"none":"block";var i=g.getAttribute("data-id").toString();document.location.href="room-upgrade.html?hotelID="+i+"&travelersInput="+b.bookingFormInfo.travelersInput+"&airportTransferType="+b.bookingFormInfo.airportTransferType}),this},delayLoadImage:function(a){for(var b=document.getElementsByClassName("ho_img"),c=0;c<b.length;c++)!function(){var a=c,d=b[a].getAttribute("real-src"),e=function(b,c){var d=new Image;d.src=b,d.onload=function(){d.onload=null,c(a)}};e(d,function(c){b[a].setAttribute("src",d)})}(c);return this},initRender:function(){var a=this,b=JSON.parse(window.localStorage.info),c=JSON.parse(localStorage.getItem("hotelResultData")),d={};return oldInfo=JSON.parse(localStorage.getItem("info")),this.oldInfo=b,a.hasChoosed=!1,d.data=c,d.success=!0,a.callBack(d),this},createTags:function(){return this},init:function(){this.createTags().initRender()}};hotelList.init(),function(){$("#fo_lo").on("click",function(){$("#l_but").addClass("s-but-checked"),$("#s_but1").addClass("s-but-checked")}),$("#l_but").on("click",function(){$("#l_but").removeClass("s-but-checked"),$("#s_but1").removeClass("s-but-checked")})}(),function(){function a(){function a(a){return document.getElementById(a)}function b(a){j=document.getElementById("r-mb"),j.style.display="block",a.style.bottom="0",a.style.transition="all 350ms"}function c(a){var b=window.innerHeight;j=document.getElementById("r-mb"),j.style.display="none",a.style.bottom=-b+"px",a.style.transition="all 350ms"}function d(){var a=window.innerHeight;j=document.getElementById("r-mb"),j=document.getElementById("r-mb"),j.style.display="none",""!=m.style.display&&"block"!=m.style.display||(m.style.bottom=-a+"px",m.style.transition="all 350ms",$("#l_but").removeClass("s-but-checked"),$("#s_but1").removeClass("s-but-checked")),""!=n.style.display&&"block"!=n.style.display||(n.style.bottom=-a+"px",n.style.transition="all 350ms",$("#l_but").removeClass("s-but-checked"),$("#s_but1").removeClass("s-but-checked")),""!=o.style.display&&"block"!=o.style.display||(o.style.bottom=-a+"px",o.style.transition="all 350ms",$("#l_but").removeClass("s-but-checked"),$("#s_but1").removeClass("s-but-checked"))}function e(){var a=window.event.srcElement,b=a.className,c=[],d=[];if("不限"==a.innerText){c=document.getElementById("h-level").childNodes;for(var e=1;e<c.length;e++)c[e].className="s-li"}"不限"!=a.innerText&&(document.getElementById("h-level").firstElementChild.className="s-li"),"s-li"==b?a.className="s-li1":a.className="s-li",c=document.getElementById("h-level").childNodes;for(var f=0,g=c.length;g>f;f++)"s-li1"==c[f].className&&d.push(c[f].innerText);0==d.length&&(document.getElementById("h-level").firstElementChild.className="s-li1")}function f(a,c){a.onclick=function(){b(c),j.addEventListener("click",d),l=document.getElementById("h-level").childNodes;for(var a=0;a<l.length;a++)l[a].addEventListener("click",e);k=document.getElementsByClassName("r-li");for(var f=0;f<k.length;f++)k[f].addEventListener("click",h);$("#l-ul").off("click"),$("#l-ul").on("click",".l-li",i)}}function g(a,b){a.onclick=function(){var d;if(a==s){newPara.StarRating="",d=document.getElementById("h-level").getElementsByTagName("li"),"s-li1"==d[0].className&&(newPara.StarRating="");for(var e=1;e<d.length;e++)"s-li1"==d[e].className&&(newPara.StarRating+=d[e].innerHTML+"$")}if(a==t){newPara.Location="",d=document.getElementById("l-ul").getElementsByTagName("li"),"l-icon1"==d[0].firstElementChild.className&&(newPara.Location="");for(var f=1;f<d.length;f++)"l-icon1"==d[f].firstElementChild.className&&(newPara.Location+=d[f].innerText+"$")}hotelList.tAjax("",newPara,"0208",3,hotelList.callBack),c(b)}}function h(){var a=window.event.srcElement,b=document.getElementById("rank"),c=document.getElementById("r-mb"),d=a.style.color;if(0==$(this).index()?delete newPara.SortType:1==$(this).index()?newPara.SortType=1:newPara.SortType=2,"rgb(252, 148, 100)"==d)c.style.display="none",b.style.bottom="-550px",b.style.transition="all 350ms";else{for(var e=0;e<k.length;e++){if("rgb(252, 148, 100)"==k[e].style.color){var f=k[e].getElementsByTagName("b")[0];k[e].removeChild(f)}k[e].style.color="#b3b2b4"}a.style.color="#fc9464";var g=document.createElement("b");g.className="hl-icon5",a.appendChild(g),c.style.display="none",b.style.bottom="-550px",b.style.transition="all 350ms"}hotelList.tAjax("",newPara,"0208",3,hotelList.callBack)}function i(a){var b=$(this),c=b.find("b"),d=c.hasClass("l-icon1");d||(c.removeClass("l-icon").addClass("l-icon1"),b.siblings().find("b").addClass("l-icon").removeClass("l-icon1"))}var j,k=[],l=[],m=a("rank"),n=a("screen"),o=a("location"),p=a("fo_ra"),q=a("fo_sc"),r=a("fo_lo"),s=a("s_but"),t=a("l_but");this.init=function(a){},init(),f(p,m),f(q,n),f(r,o),g(s,n),g(t,o)}a()}();