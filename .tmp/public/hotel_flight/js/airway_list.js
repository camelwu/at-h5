/*! asiatravel FE team at-h5-nodejs-----2016-05-19T15:21:43 */
var changeFlightInfo,airwayLiat={requestUrl:"http://10.6.11.28:1337/api/GetServiceApiResult",getWeekDay:function(a){var b=a.substr(0,10).replace(/-/g,"/"),c="周"+"日一二三四五六".split("")[new Date(b).getDay()];return c},formatDate:function(a,b){a.indexOf("T")>-1&&(a=a.replace("T"," "),a.indexOf("-")>-1&&(a=a.replace(/-/g,"/")),a=new Date(a));var c=function(a){return a+="",a.replace(/^(\d)$/,"0$1")},d={yyyy:a.getFullYear(),yy:a.getFullYear().toString().substring(2),M:a.getMonth()+1,MM:c(a.getMonth()+1),d:a.getDay(),dd:c(a.getDate()),hh:c(a.getHours()),mm:c(a.getMinutes()),ss:c(a.getSeconds())};return b||(b="yyyy-MM-dd hh:mm:ss"),b.replace(/([a-z])(\1)*/gi,function(a){return d[a]})},getweekly:function(a){return week=["日","一","二","三","四","五","六"],week[a]},getAirwayInfo:function(){var a=this,b=changeFlightInfo.data;$("#departData").html(a.formatDate(b.DepartDate,"MM-dd")),$("#returnData").html(a.formatDate(b.ReturnDate,"MM-dd")),$("#departWeek").html("周"+a.getweekly(a.formatDate(b.DepartDate,"d"))),$("#returnWeek").html("周"+a.getweekly(a.formatDate(b.ReturnDate,"d")));var c=function(a){var b=a,c=b.data;if(b.success){$(".set-place").html(c.flightInfoListGroup[0].flightInfoList[0].cityNameFrom),$(".to-place").html(c.flightInfoListGroup[0].flightInfoList[0].cityNameTo);var d=['<li class="airway" data-airwaySetID="{%=airwaySetID%}" data-airwayCacheID="{%=airwayCacheID%}">',"<div>",'<img src="{%=airwayLogo%}" />',"</div>",'<span class="airway-name">{%=chineseName%}</span>','<div class="aw-price">',"<apan>+￥</apan><apnn >{%=additionalPrice%}</apnn>","</div>",'<b class="hf-icon"></b>',"</li>"].join(""),e=template(d,c.airways);$("#airway_list").html(e),$(".airway").click(function(){$(this).find("b.hf-icon").addClass("cho-gou").parents().siblings().find("b.hf-icon").removeClass("cho-gou");var a=$(this).attr("data-airwaySetID"),b=$(this).attr("data-airwayCacheID");changeFlightInfo.data.AirwayCacheID=b,changeFlightInfo.data.AirwaySetID=a,localStorage.changeFlightParaObj=JSON.stringify(changeFlightInfo),window.location.href="ticket-list.html"})}else jAlert(b.message,"提示")};this.tAjax("",b,"50100002","3",c)},tAjax:function(a,b,c,d,e){var f=this,g={Parameters:b,ForeEndType:d,Code:c};a=a?a:f.requestUrl,vlm.loadJson(a,JSON.stringify(g),e)},init:function(){changeFlightInfo=JSON.parse(localStorage.changeFlightParaObj),this.getAirwayInfo()}};airwayLiat.init();