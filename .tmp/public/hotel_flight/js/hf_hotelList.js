/*! asiatravel FE team at-h5-nodejs-----2016-05-19T16:09:38 */
!function(){function a(a){for(var b=a.length,c=0;b>c;c++)switch(a[c].starRating){case"1":a[c].starRating="一";break;case"2":a[c].starRating="二";break;case"3":a[c].starRating="三";break;case"4":a[c].starRating="四";break;case"5":a[c].starRating="五"}return a}function b(b){var f="yes"==$("#loadMore").attr("data-more");if(b.success&&"200"==b.code){if(!f&&0==b.data.hotels.length)return void c();var g=b.data,h=template("hj_list_template",a(g.hotels));f?$("#hj_jList").html($("#hj_jList").html()+h):$("#hj_jList").html(h),s=g.locationList,$("#totalHotels").html(g.totelHotelCount),1==t&&(e(s),t++);new lazyLoad("hj_jList");p=g.pageNo,g.pageNo<g.pageCount?$("#loadMore").attr("data-more","").html("点击加载更多").show():g.pageNo>=g.pageCount?$("#loadMore").attr("data-more","no").html("没有更多数据了！").show():$("#loadMore").attr("data-more","").html("点击加载更多").hide(),d()}else c()}function c(){$("#loadMore").hide();var a=document.createElement("li");a.innerHTML='<div><img src="../images/hotelListNo.jpg" /><p class="hotelConSorry1">非常抱歉，无符合要求的酒店。</p><p class="hotelConSorry2">建议您扩大搜索范围</p></div>',a.className="hotelConNo",$("#hj_jList").empty().append(a).css({width:"100%",height:"100%"})}function d(){var a=localStorage.getItem("filterStarRating")||[0],b=u.Parameters.Location,c=u.Parameters.SortFields;u.Parameters.StarRating;""!=b?$(".fo-location i").addClass("red-tip"):$(".fo-location i").removeClass("red-tip"),0!=c[0]?$(".fo-sort i").addClass("red-tip"):$(".fo-sort i").removeClass("red-tip"),"0"!=a?$(".fo-filter i").addClass("red-tip"):$(".fo-filter i").removeClass("red-tip"),$(c).each(function(a,b){$(".jpop .sort li").each(function(a,c){$(c).attr("data-sort")==b&&$(c).addClass("cur")})}),$("#h-level li").each(function(b,c){for(var d=a,e=0;e<d.length;e++){if($(c).attr("data-start")==d[e]){$(c)[0].className="s-li1";break}$(c)[0].className="s-li"}}),$(b.split("||")).each(function(a,b){$("#locationList li").each(function(a,c){$(c).attr("data-location")==b&&$(c).trigger("click")})})}function e(a){var b=a||[],c=document.getElementById("locationList");c.innerHTML='<li class="l-li l-liFirst"><p class="l-p">不限</p><b class="l-icon1 l-icon1First"></b></li>';for(var d="",e=0;e<b.length;e++)d+='<li class="l-li" data-location="'+b[e]+'"><p class="l-p">'+b[e]+'</p><b class="l-icon1"></b></li>';c.innerHTML+=d;for(var f=$("#locationList .l-liFirst"),g=$("#locationList .l-li"),h=($("#locationList .l-icon1"),$("#locationList .l-icon1First")[0],!0),i={},e=1;e<g.length;e++)i[e]=!0;f.on("click",function(a){f.removeClass("l-li3");for(var b=1;b<g.length;b++)g.eq(b).removeClass("l-li2");for(var b=1;b<g.length;b++)i[b]=!0});for(var e=1;e<g.length;e++)!function(a){g.eq(a).on("click",function(b){i[a]?g.eq(a).addClass("l-li2"):g.eq(a).removeClass("l-li2"),i[a]=!i[a];for(var c=0,d=1;d<g.length;d++)i[d]?c++:(f.addClass("l-li3"),h=!1);c==g.length-1&&(f.removeClass("l-li3"),h=!0)})}(e)}function f(){var a=localStorage.getItem("flighHotelParams"),c="";a?(c=a,u=JSON.parse(a)):c=JSON.stringify(u),vlm.loadJson("",c,b)}function g(){var a="",b=$(".jpop .sort .cur").attr("data-sort")||0;u.Parameters.SortFields=[b];for(var c=$("#screen .s-li1"),d=[],e="",f="",g="",i="",j=0;j<c.length;j++)switch(c[j].innerText){case"不限":d.push("0"),e+="不限$",f+="0$";break;case"二星级以下":d.push("1"),e+="二星级以下$",f+="1$";break;case"三星":d.push("2"),e+="三星$",f+="2$";break;case"四星":d.push("4"),e+="四星$",f+="4$";break;case"五星":d.push("8"),e+="五星$",f+="8$";break;case"酒店":g+="1$",e+="酒店$",i+="1$";break;case"汽车旅馆":g+="2$",e+="汽车旅馆$",i+="2$";break;case"酒店式公寓":g+="3$",e+="酒店式公寓$",i+="2$";break;case"家庭旅馆":g+="4$",e+="家庭旅馆$",i+="4$";break;case"背包客栈":g+="5$",e+="背包客栈$",i+="5$";break;case"宾馆/招待所":g+="6$",e+="宾馆/招待所$",i+="6$";break;case"精品酒店":g+="7$",e+="精品酒店$",i+="7$";break;case"度假类酒店":g+="8$",e+="度假类酒店$",i+="8$";break;case"游轮度假酒店":g+="9$",e+="游轮度假酒店$",i+="9$";break;case"别墅型酒店":g+="10$",e+="别墅型酒店$",i+="10$";break;case"乡村平房酒店":g+="11$",e+="乡村平房酒店$",i+="11$";break;case"家庭寄宿":g+="12$",e+="家庭寄宿$",i+="12$";break;case"农舍式房子":g+="13$",e+="农舍式房子$",i+="13$";break;case"豪华露营地":g+="14$",e+="豪华露营地$",i+="14$";break;case"标准露营地":g+="15$",e+="标准露营地$",i+="15$"}var k=$("#locationList .l-li2"),l=[];return k.each(function(a,b){l.push($(b).text())}),localStorage.setItem("filterStarRating",d.join("")),u.Parameters.StarRating=h(d),u.Parameters.Location=l.join("||"),a=JSON.stringify(u),localStorage.setItem("flighHotelParams",a),a}function h(a){for(var b=0,c=0,d=a.length;d>c;c++)b+=parseInt(a[c]);return b}function i(){var a=g();vlm.loadJson("",a,b)}function j(){var a=g();vlm.loadJson("",a,b)}function k(){var a=g();vlm.loadJson("",a,b),vlm.loadJ}function l(){var a=$("#loadMore");if("no"!=a.attr("data-more")){a.attr("data-more","yes"),u.Parameters.PageNo=p+1;var c=g();$("#loadMore").html("正在加载..."),vlm.loadJson("",c,b,!1,!1,!0)}}function m(a){var b=a.target||window.event.srcElement,c=b.className,d=[],e=[];if("不限"==b.innerText){d=document.getElementById("h-level").childNodes;for(var f=1;f<d.length;f++)d[f].className="s-li"}"不限"!=b.innerText&&(document.getElementById("h-level").firstElementChild.className="s-li"),"s-li"==c?b.className="s-li1":b.className="s-li",d=document.getElementById("h-level").childNodes;for(var g=0,h=d.length;h>g;g++)"s-li1"==d[g].className&&e.push(d[g].innerText);0==e.length&&(document.getElementById("h-level").firstElementChild.className="s-li1")}function n(){function a(a){var a=a||window.event;$(".jpop,.jpop .screen,.jpop .sort,.jpop .location").hide(),a.preventDefault()}$("#loadMore").on("click",function(){l()}),$(".j-bottom .fo-sort").on("click",function(){$(".jpop,.jpop .sort").show()}),$(".jpop .sort").on("click","li",function(){$(this).addClass("cur").siblings().removeClass("cur"),$(".jpop,.jpop .sort").hide(),i()}),$(".j-bottom .fo-filter").on("click",function(){$(".jpop,.jpop .screen").show()}),$("#h-level").on("click","li",m),$("#s_but").on("click",function(a){$(".jpop,.jpop .screen").hide(),j()}),$(".j-bottom .fo-location").on("click",function(){$(".jpop,.jpop .location").show()}),$("#sureBtn").on("click",function(a){$(".jpop,.jpop .location").hide(),k()}),$(".j-back").on("click",function(){localStorage.removeItem("flighHotelParams"),window.history.go(-1)});var b=document.getElementById("mask");b.addEventListener("touchstart",a,!1),$("#hj_jList").on("click","li",function(a){var b=$(this),c=b.attr("data-hotelid");if(c){b.find("i").addClass("active"),q.data.HotelID=c,localStorage.setItem("hotelDetailInfo",JSON.stringify(q));var d=setTimeout(function(){window.location.href="hotel_detail.html",clearTimeout(d)},500)}})}function o(){f(),n()}var p,q=JSON.parse(localStorage.getItem("changeHotelParaObj"))||{},r=q.data,s=null,t=(JSON.parse(localStorage.getItem("filterStarRating"))||"0",1),u={Code:"50100003",ForeEndType:2,Parameters:{SelectedHotelID:r.SelectedHotelID||"",FlightCacheID:r.FlightCacheID||"",FlightSetID:r.FlightSetID||"",CityCodeFrom:r.CityCodeFrom||"",CityCodeTo:r.CityCodeTo||"",DepartDate:r.DepartDate||"",ReturnDate:r.ReturnDate||"",SortFields:r.SortFields||[0],StarRating:0,PageNo:r.PageNo||"",PageSize:r.PageSize||"",RoomDetails:r.RoomDetails||[],Location:r.Location||""}};o()}();