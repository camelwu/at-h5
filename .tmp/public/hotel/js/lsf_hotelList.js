/*! asiatravel FE team at-h5-nodejs-----2016-05-19T15:21:43 */
function num2chin(a){switch(a){case"0":return"零";case"1":return"一";case"2":return"二";case"3":return"三";case"4":return"四";case"5":return"五";default:return"二"}}function url2json(a){if(a){for(var b={},c=a.split("?"),d=c[1].split("&"),e=0;e<d.length;e++){var f=d[e].split("=");b[f[0]]=f[1]}return b}}function styleChange(a,b){var c=document.getElementById(a);c.onfocus=function(){this.value==b&&(this.value="",this.style.color="#484848")},c.onblur=function(){this.value||(this.value=b,this.style.color="#d1d1d1")}}!function(a){a(document).ready(function(){window.addEventListener("load",function(){FastClick.attach(document.body)},!1)})}(jQuery);var lsf_myweb={getbyid:function(a){return document.getElementById(a)},getbytag:function(a,b){return a.getElementsByTagName(b)},getbyclass:function(a,b){if(a.getElementsByClassName)return a.getElementsByClassName(b);for(var c=[],d=a.getElementsByTagName("*"),e=new RegExp("\\b"+b+"\\b","g"),f=0;f<d.length;f++)-1!=d[f].className.search(e)&&c.push(d[f]);return c},addClass:function(a,b){if(a.className){var c=RegExp("\\b"+b+"\\b","g");-1==a.className.search(c)&&(a.className+=" "+b)}else a.className=b},removeClass:function(a,b){if(a.className){var c=new RegExp("\\b"+b+"\\b","g");-1!=a.className.search(c)&&(a.className=a.className.replace(c,"").replace(/^\s+|\s+$/g,"").replace(/\s+/g," "),a.className||a.removeAttribute("class"))}},bind:function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},removeBind:function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)},setSession:function(a,b){window.sessionStorage.setItem(a,JSON.stringify(b))},getSession:function(a){return JSON.parse(window.sessionStorage.getItem(a))}},hlHis=lsf_myweb.getSession("asiaHlHistory")||{};lsf_myweb.setSession("asiaHlHistory",hlHis),function(){function a(){$("#fo_lo").on("click",function(){$("#l_but").addClass("s-but-checked"),$("#s_but1").addClass("s-but-checked")})}function b(){$("#l_but").on("click",function(){$("#l_but").removeClass("s-but-checked"),$("#s_but1").removeClass("s-but-checked")})}function c(){function a(a){return document.getElementById(a)}function b(a){j=document.getElementById("r-mb"),j.style.display="block",a.style.bottom="0",a.style.transition="all 350ms"}function c(a){var b=window.innerHeight;j=document.getElementById("r-mb"),j.style.display="none",a.style.bottom=-b+"px",a.style.transition="all 350ms"}function d(){var a=window.innerHeight;j=document.getElementById("r-mb"),j=document.getElementById("r-mb"),j.style.display="none",""!=n.style.display&&"block"!=n.style.display||(n.style.bottom=-a+"px",n.style.transition="all 350ms",$("#l_but").removeClass("s-but-checked"),$("#s_but1").removeClass("s-but-checked")),""!=o.style.display&&"block"!=o.style.display||(o.style.bottom=-a+"px",o.style.transition="all 350ms",$("#l_but").removeClass("s-but-checked"),$("#s_but1").removeClass("s-but-checked")),""!=p.style.display&&"block"!=p.style.display||(p.style.bottom=-a+"px",p.style.transition="all 350ms",$("#l_but").removeClass("s-but-checked"),$("#s_but1").removeClass("s-but-checked"))}function e(){var a=window.event.srcElement,b=a.className,c=[],d=[];if("不限"==a.innerText){c=document.getElementById("h-type").childNodes;for(var e=1;e<c.length;e++)c[e].className="s-li"}"不限"!=a.innerText&&(document.getElementById("h-type").firstElementChild.className="s-li"),"s-li"==b?a.className="s-li1":a.className="s-li",c=document.getElementById("h-type").childNodes;for(var f=0,g=c.length;g>f;f++)"s-li1"==c[f].className&&d.push(c[f].innerText);0==d.length&&(document.getElementById("h-type").firstElementChild.className="s-li1")}function f(){var a=window.event.srcElement,b=a.className,c=[],d=[];if("不限"==a.innerText){c=document.getElementById("h-level").childNodes;for(var e=1;e<c.length;e++)c[e].className="s-li"}"不限"!=a.innerText&&(document.getElementById("h-level").firstElementChild.className="s-li"),"s-li"==b?a.className="s-li1":a.className="s-li",c=document.getElementById("h-level").childNodes;for(var f=0,g=c.length;g>f;f++)"s-li1"==c[f].className&&d.push(c[f].innerText);0==d.length&&(document.getElementById("h-level").firstElementChild.className="s-li1")}function g(a,c){a.onclick=function(){b(c),j.addEventListener("click",d)}}function h(a,b){a.onclick=function(){c(b)}}function i(){var a=window.event.srcElement,b=document.getElementById("rank"),c=document.getElementById("r-mb"),d=a.style.color;if("rgb(252, 148, 100)"==d)c.style.display="none",b.style.bottom="-550px",b.style.transition="all 350ms";else{for(var e=0;e<k.length;e++){if("rgb(252, 148, 100)"==k[e].style.color){var f=k[e].getElementsByTagName("b")[0];k[e].removeChild(f)}k[e].style.color="#b3b2b4"}a.style.color="#fc9464";var g=document.createElement("b");g.className="hl-icon5",a.appendChild(g),c.style.display="none",b.style.bottom="-550px",b.style.transition="all 350ms"}}var j,k=[],l=[],m=[],n=a("rank"),o=a("screen"),p=a("location"),q=a("fo_ra"),r=a("fo_sc"),s=a("fo_lo"),t=a("s_but"),u=a("l_but");this.init=function(a){l=document.getElementById("h-level").childNodes;for(var b=0;b<l.length;b++)l[b].addEventListener("click",f);m=document.getElementById("h-type").childNodes;for(var c=0;c<m.length;c++)m[c].addEventListener("click",e);k=document.getElementsByClassName("r-li");for(var d=0;d<k.length;d++)k[d].addEventListener("click",i)},init(),g(q,n),g(r,o),g(s,p),h(t,o),h(u,p)}function d(a){function b(a){return-1!=a.indexOf("(")&&(a=a.substring(0,a.indexOf("("))),a}s.style.display="block";document.getElementById("lsf_list");a=a||{},a.rank=a.rank||"",a.InterCityName=decodeURIComponent(a.InterCityName)||"Singapore",a.DomCityName=decodeURIComponent(a.DomCityName)||"北京",a.NumRoom=a.NumRoom||"1",a.NumChild=a.NumChild||"1",a.NumAdult=a.NumAdult||"1",a.Category=a.Category||"",a.StarRating=a.StarRating||"",a.LocationList=a.LocationList||"",a.CountryISOCode=a.CountryISOCode||"SG",a.pageIndex=a.pageIndex||1,a.pageSize=a.pageSize||20;var c=new Date,d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate();a.InterCheckInDate=a.InterCheckInDate||d+"-"+e+"-"+f,a.InterCheckOutDate=a.InterCheckOutDate||d+"-"+e+"-"+(f+1);var g=localStorage.getItem("hoPos"),h=JSON.parse(window.localStorage.getItem("cityListInfo")),j=document.getElementById("fo_ra"),k=document.getElementById("fo_sc"),l=document.getElementById("fo_lo");if(""!=a.rank&&"PriorityDESC"!=a.rank?j.querySelector("i").className="red-tip":j.querySelector("i").className="",""!=a.Category||""!=a.StarRating?k.querySelector("i").className="red-tip":k.querySelector("i").className="",""!=a.LocationList?l.querySelector("i").className="red-tip":l.querySelector("i").className="",a.InterCityName=b(a.InterCityName),a.DomCityName=b(a.DomCityName),"inter"==g){var m=/^([\u4e00-\u9fa5])*$/;if(m.test(a.InterCityName))for(var n=0;n<h.length;n++)if(a.InterCityName==h[n].cityNameCN){a.InterCityName=h[n].cityNameEN,a.CountryISOCode=h[n].countryISOCode;break}var o={Parameters:'{"CultureName":"zh-CN","PartnerCode":"1000","CountryISOCode":"'+a.CountryISOCode+'","CityName":"'+a.InterCityName+'","CheckInDate":"'+a.InterCheckInDate+'T00:00:00","CheckOutDate":"'+a.InterCheckOutDate+'T00:00:00","NumRoom":'+a.NumRoom+',"NumAdult":'+a.NumAdult+',"NumChild":'+a.NumChild+',"InstantConfirmation":true,"AllOccupancy":true,"PageIndex":"'+a.pageIndex+'","PageSize":"'+a.pageSize+'","sorttype":"'+a.rank+'","Category":"'+a.Category+'","StarRating":"'+a.StarRating+'","LocationList":"'+a.LocationList+'"}',Code:"0007",ForeEndType:3}}else if(g="dom"){for(var n=0;n<h.length;n++)if(a.DomCityName==h[n].cityNameCN){a.DomCityName=h[n].cityNameEN,a.CountryISOCode=h[n].countryISOCode;break}var o={Parameters:'{"CultureName":"zh-CN","PartnerCode":"1000","CountryISOCode":"'+a.CountryISOCode+'","CityName":"'+a.DomCityName+'","CheckInDate":"'+a.DomCheckInDate+'T00:00:00","CheckOutDate":"'+a.DomCheckOutDate+'T00:00:00","NumRoom":"","NumAdult":"","NumChild":"","InstantConfirmation":true,"AllOccupancy":true,"PageIndex":"'+a.pageIndex+'","PageSize":"'+a.pageSize+'","sorttype":"'+a.rank+'","Category":"'+a.Category+'","StarRating":"'+a.StarRating+'","LocationList":"'+a.LocationList+'"}',Code:"0007",ForeEndType:3}}return document.getElementById("lsf_list").setAttribute("data-index",a.pageIndex),1==a.pageIndex?vlm.loadJson("",JSON.stringify(o),i):vlm.loadJson("",JSON.stringify(o),i,!1,!1,!0)}function e(a){function b(){var a=document.getElementById("l-ul");a.innerHTML='<li class="l-li l-liFirst"><p class="l-p">不限</p><b class="l-icon1 l-icon1First"></b></li>';for(var b=0;b<c.length;b++){var d='<li class="l-li"><p class="l-p">{$adress$}</p><b class="l-icon1"></b></li>';d=d.replace(/\{\$\w+\$\}/g,function(a){return c[b]}),a.innerHTML+=d}for(var e=lsf_myweb.getbyclass(a,"l-liFirst")[0],f=lsf_myweb.getbyclass(a,"l-li"),g=(lsf_myweb.getbyclass(a,"l-icon1"),lsf_myweb.getbyclass(a,"l-icon1First")[0],!0),h={},b=1;b<f.length;b++)h[b]=!0;lsf_myweb.bind(e,"click",function(){lsf_myweb.removeClass(e,"l-li3");for(var a=1;a<f.length;a++)lsf_myweb.removeClass(f[a],"l-li2");for(var a=1;a<f.length;a++)h[a]=!0});for(var b=1;b<f.length;b++)!function(a){lsf_myweb.bind(f[a],"click",function(){h[a]?lsf_myweb.addClass(f[a],"l-li2"):lsf_myweb.removeClass(f[a],"l-li2"),h[a]=!h[a];for(var b=0,c=1;c<f.length;c++)h[c]?b++:(lsf_myweb.addClass(e,"l-li3"),g=!1);b==f.length-1&&(lsf_myweb.removeClass(e,"l-li3"),g=!0)})}(b)}if(a){var c=a.locationList,a=a.hotelList,d=null,e=lsf_myweb.getbyid("lsf_list"),f="",g=document.getElementById("lsf_list").getAttribute("data-index")>1;if(g||(m.innerHTML=""),a.length){for(var i=0;i<a.length;i++){var k=a[i].starRating.substring(0,1),l="",o="",q="";a[i].isFreeWiFi&&(l+='<span class="h-wifi"></span>'),a[i].isFreeTransfer&&(l+='<span class="h-transfer"></span>'),a[i].isCashRebate&&(o='<div class="h-div1" style="background-color: #ffb412">返现</div>'),a[i].isFreeCityTour&&(q='<div class="h-div1">免费景点</div>');var s=null!=a[i].hotelNameLocale&&""!=a[i].hotelNameLocale?a[i].hotelNameLocale+"("+a[i].hotelName+")":a[i].hotelName,t='<li class="ho_list" data-hotelCode="'+a[i].hotelCode+'" data-InstantConfirmation="'+a[i].InstantConfirmation+'" data-AllOccupancy="'+a[i].AllOccupancy+'"><div class="ho_pic"><img  src="../images/loading-hotel.gif" data-src="'+a[i].frontPgImage+'" class="ho_img"/ data-all="'+a[i]+'"></div><div class="ho_infor"><p class="hname"  style="font-size:1.6rem;width:'+n+'px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;-webkit-text-overflow:ellipsis">'+s+'</p><div class="h-score"><span style="color:#8ed1cc;font-size:1.5rem;font-weight: 600;">'+(parseFloat(a[i].hotelReviewScore)?a[i].hotelReviewScore+'</span><span style="color:#999999;font-size:1rem;">分/'+(parseFloat(a[i].hotelReviewCount)?a[i].hotelReviewCount:"")+"人点评</span>":'</span><span style="color:#fff;font-size:1rem;">分/'+(parseFloat(a[i].hotelReviewCount)?a[i].hotelReviewCount:"")+"人点评</span>")+'<p class="hl_price"><span style="font-size:12px;color:#fe4716;">￥</span><span style="font-size:2rem;font-weight: 600;color:#fe4716;">'+a[i].avgPriceCNY+'</span><span style="font-size:1.2rem;color:#999999;">起</span></p></div><div class="h-grade"><span style="color:#999999;font-size:1rem;">'+num2chin(k)+"星级</span>"+l+o+q+'</div><p class="h-address">'+a[i].location+"</p></div></li>";f+=t}e.style.height="";var d=setTimeout(function(){m.innerHTML+=f;var b=document.getElementById("loadMore");b.style.display="block",a.length<p.pageSize?(b.setAttribute("data-more","no"),b.innerHTML="没有更多数据了"):(b.setAttribute("data-more","yes"),b.innerHTML="点击加载更多");m.children,lsf_myweb.getbyclass(m,"hname"),new lazyLoad("lsf_list");j(a),clearTimeout(d)},50)}else if(p.pageIndex>1)document.getElementById("loadMore").innerHTML="没有更多数据了";else{document.getElementById("loadMore").style.display="none";var u=document.createElement("li");u.innerHTML='<div><img src="../images/hotelListerrorpic.png" /><p class="hotelConSorry1">非常抱歉，无符合要求的酒店。</p><p class="hotelConSorry2">建议您扩大搜索范围</p></div>',u.className="hotelConNo",e.style.width="100%",e.style.height="100%",e.appendChild(u)}r&&b(),r=!1,h(),$(function(){var a=null;clearInterval(a),a=setInterval(function(){$("#lsf_list").children().length&&($("#status-h").fadeOut(),$("#preloader").delay(400).fadeOut("medium"),clearInterval(a))},30)})}}function f(){var a=lsf_myweb.getbyid("rank").children,b=JSON.parse(window.sessionStorage.getItem("asiaHlHistory"));if(b.hlSort)for(var c=0;c<a.length;c++)if(b.hlSort.chinese&&-1!=a[c].innerHTML.indexOf(b.hlSort.chinese)){p.rank=b.hlSort.english;for(var d=0;d<a.length;d++){a[d].style.color="#b3b2b4";var e=a[d].getElementsByTagName("b");e.length&&a[d].removeChild(e[0])}a[c].style.color="#fc9464";var f=document.createElement("b");f.className="hl-icon5",a[c].appendChild(f)}}function g(){function a(a){for(var c=!1,d=0;d<a.length;d++)-1!=b.hlFilter.chinese.indexOf(a[d].innerText)?(c=!0,a[d].className="s-li1"):a[d].className="s-li";c||(a[0].className="s-li1")}var b=JSON.parse(window.sessionStorage.getItem("asiaHlHistory"));if(b.hlFilter){var c=document.getElementById("h-level"),d=document.getElementById("h-type"),e=c.children,f=d.children;a(e),a(f),p.StarRating=b.hlFilter.star,p.Category=b.hlFilter.hotelType}}function h(){function a(a){var c=b.hlLocation.list.split("$"),e=c.length;e>1&&d[0]&&d[0].classList.add("l-li3");for(var f=0;f<a.length;f++)for(var g=0;e>g;g++)a[f].firstChild.innerText==c[g]&&a[f].classList.add("l-li2")}var b=JSON.parse(window.sessionStorage.getItem("asiaHlHistory"));if(b.hlLocation){var c=document.getElementById("l-ul"),d=c.children;a(d),p.LocationList=b.hlLocation.list}}function i(a){var b=a;if(b.success){var c=b.data[0];e(c)}else if("There is no hotel on the selected destination."==b.message){var c={hotelList:[],locationList:[]};e(c)}else{var c={hotelList:[],locationList:[]};e(c)}}function j(a){for(var b=document.getElementsByClassName("ho_list"),c=function(a){var b=new Object;b.HotelID=a.getAttribute("data-hotelCode"),b.HotelCode=a.getAttribute("data-hotelCode"),b.InstantConfirmation=void 0!=a.getAttribute("data-InstantConfirmation")&&"undefined"!=a.getAttribute("data-InstantConfirmation")?a.getAttribute("data-InstantConfirmation"):!1,b.AllOccupancy=void 0!=a.getAttribute("data-AllOccupancy")&&"undefined"!=a.getAttribute("data-AllOccupancy")?a.getAttribute("data-AllOccupancy"):!0,b.CheckInDate=p.InterCheckInDate,b.CheckOutDate=p.InterCheckOutDate,b.NumRoom=p.NumRoom,b.NumAdult=p.NumAdult,b.NumChild=p.NumChild;var c="";for(var d in b)c+="&"+d+"="+b[d];c=c.slice(1),window.location.href="hotel_detail.html?"+c},d=0;d<b.length;d++)b[d].onclick=function(){var a=this;c(a)}}function k(){var a=document.getElementById("loadMore"),b=p.pageIndex+1,c=a.getAttribute("data-more");"no"!=c&&(a.innerHTML="正在加载...",p.pageIndex=b,d(p))}a(),b(),c();var l=document.getElementById("hl_back");lsf_myweb.bind(l,"click",function(){lsf_myweb.setSession("asiaHlHistory",{}),window.location.href="index.html"});document.getElementById("lsf_list");$(window).load(function(){var a=null;a=setInterval(function(){$("#lsf_list").children().length&&($("#status-h").fadeOut(),$("#preloader").delay(400).fadeOut("medium"),clearInterval(a))},30)});var m=lsf_myweb.getbyid("lsf_list"),n=m.offsetWidth-125,o=window.location.href,p=url2json(o),q=document.getElementsByTagName("body")[0],r=(document.getElementById("s_but"),!0),s=document.getElementById("preloader");document.getElementById("status");f(),g(),h(),d(p),lsf_myweb.bind(q,"click",function(a){var b=a||event,c=b.srcElement||b.target;if(hlHis.hlSort=hlHis.hlSort||{},hlHis.hlSort.chinese=hlHis.hlSort.chinese||"",hlHis.hlSort.english=hlHis.hlSort.english||"","r-li"==c.className){var e=c.innerHTML;-1!=e.indexOf("推荐排序")?(p.rank="PriorityDESC",hlHis.hlSort.chinese="推荐排序",hlHis.hlSort.english="PriorityDESC"):-1!=e.indexOf("价格升序")?(p.rank="PriceASC",hlHis.hlSort.chinese="价格升序",hlHis.hlSort.english="PriceASC"):-1!=e.indexOf("价格降序")?(p.rank="PriceDESC",hlHis.hlSort.chinese="价格降序",hlHis.hlSort.english="PriceDESC"):-1!=e.indexOf("好评优先")&&(p.rank="ReviewscoreDESC",hlHis.hlSort.chinese="好评优先",hlHis.hlSort.english="ReviewscoreDESC"),lsf_myweb.setSession("asiaHlHistory",hlHis),p.pageIndex=1,d(p)}}),lsf_myweb.bind(q,"click",function(a){var b=a||event,c=document.getElementById("screen"),e=b.srcElement||b.target,f=document.documentElement.clientHeight;if(c.style.maxHeight=f-45+"px","s_but"==e.getAttribute("id")){var g="",h="",i="",j="",k="",l=lsf_myweb.getbyclass(lsf_myweb.getbyid("screen"),"s-li1");hlHis.hlFilter=hlHis.hlFilter||{},hlHis.hlFilter.chinese=hlHis.hlFilter.chinese||"",hlHis.hlFilter.star=hlHis.hlFilter.star||"",hlHis.hlFilter.hotelType=hlHis.hlFilter.hotelType||"";for(var m=0;m<l.length;m++)switch(l[m].innerText){case"二星级以下":g+="2$",i+="二星级以下$",j+="2$";break;case"三星":g+="3$",i+="三星$",j+="3$";break;case"四星":g+="4$",i+="四星$",j+="4$";break;case"五星":g+="5$",i+="五星$",j+="5$";break;case"酒店":h+="1$",i+="酒店$",k+="1$";break;case"汽车旅馆":h+="2$",i+="汽车旅馆$",k+="2$";break;case"酒店式公寓":h+="3$",i+="酒店式公寓$",k+="2$";break;case"家庭旅馆":h+="4$",i+="家庭旅馆$",k+="4$";break;case"背包客栈":h+="5$",i+="背包客栈$",k+="5$";break;case"宾馆/招待所":h+="6$",i+="宾馆/招待所$",k+="6$";break;case"精品酒店":h+="7$",i+="精品酒店$",k+="7$";break;case"度假类酒店":h+="8$",i+="度假类酒店$",k+="8$";break;case"游轮度假酒店":h+="9$",i+="游轮度假酒店$",k+="9$";break;case"别墅型酒店":h+="10$",i+="别墅型酒店$",k+="10$";break;case"乡村平房酒店":h+="11$",i+="乡村平房酒店$",k+="11$";break;case"家庭寄宿":h+="12$",i+="家庭寄宿$",k+="12$";break;case"农舍式房子":h+="13$",i+="农舍式房子$",k+="13$";break;case"豪华露营地":h+="14$",i+="豪华露营地$",k+="14$";break;case"标准露营地":h+="15$",i+="标准露营地$",k+="15$"}g=g.substring(0,g.length-1),h=h.substring(0,h.length-1),hlHis.hlFilter.chinese=i.substring(0,i.length-1),hlHis.hlFilter.hotelType=k.substring(0,k.length-1),hlHis.hlFilter.star=j.substring(0,j.length-1),lsf_myweb.setSession("asiaHlHistory",hlHis),p.StarRating=g,p.Category=h,p.pageIndex=1,d(p)}}),lsf_myweb.bind(q,"click",function(a){var b=a||event,c=document.getElementById("location"),e=document.getElementById("loca_con"),f=document.getElementById("loca_conBro");hlHis.hlLocation=hlHis.hlLocation||{},hlHis.hlLocation.list=hlHis.hlLocation.list||"";var g=document.documentElement.clientHeight;f.style.height=e.offsetHeight+"px",e.style.bottom="0",c.style.maxHeight=g-45+"px";var h=b.srcElement||b.target,i="";if("l_but"==h.getAttribute("id")){for(var j=lsf_myweb.getbyclass(lsf_myweb.getbyid("l-ul"),"l-li2"),k=0;k<j.length;k++){var l=j[k].children[0];i+=l.innerHTML+"$",k==j.length-1&&(i+=l.innerHTML)}hlHis.hlLocation.list=i,lsf_myweb.setSession("asiaHlHistory",hlHis),p.LocationList=i,p.pageIndex=1,d(p)}}),lsf_myweb.bind(document.getElementById("loadMore"),"click",function(a){k()})}();