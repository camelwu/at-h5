/*! asiatravel FE team at-h5-nodejs-----2016-05-19T16:09:38 */
!function(){function a(a,b,c,d,e){var f=this,g={Parameters:b,ForeEndType:d,Code:c};a=a||f.requestUrl,vlm.loadJson(a,JSON.stringify(g),e)}function b(b){if(!b.success||"200"!=b.code)return vlm.init(),void i();var d=b.data;e(d),f(b),$("#loadMore").on("click",function(){g()}),h(d);var k={hotelSort:{title:"推荐排序",c:"foot_sort",s:1,type:1,key:"sortTypes",listData:[{sortText:"价格从高至低",sortValue:4},{sortText:"价格从低至高",sortValue:3},{sortText:"星级从高到低",sortValue:2},{sortText:"星级从低到高",sortValue:1}]},hotelScreen:{title:"筛选",c:"foot_screen",s:2,type:2,key:"filters",listData:[{title:"星级",filterType:1,item:c(d)}]},hotelPosition:{title:"位置",c:"foot_position",s:2,type:2,key:"locationList",listData:d.locationList}},l=function(b){j.sortFields=b.sortTypes,j.Location=b.locationList;for(var c=b.filters,d=0,e=0;e<c.length;e++)d+=c[e].FilterValues[0]-0;j.StarRating=d,$(".status").fadeIn("fast"),a("",j,"50100003","2",f)};footer&&(footer.data=k,footer.callback=l),footer.filters.init(),vlm.init()}function c(a){for(var b=[],c={},d=a.starRatingList,e=0;e<d.length;e++){switch(d[e].starRatingName){case"1":d[e].starRatingName="不限";break;case"2":d[e].starRatingName="二星以下";break;case"3":d[e].starRatingName="三星级";break;case"4":d[e].starRatingName="四星级";break;case"5":d[e].starRatingName="五星级"}c={filterText:d[e].starRatingName,filterValue:d[e].starRatingValue},b.push(c)}return b}function d(a){for(var b=a.data.hotels,c=0;c<b.length;c++)switch(b[c].starRating){case"1":b[c].starRating="一星级";break;case"2":b[c].starRating="二星级";break;case"3":b[c].starRating="三星级";break;case"4":b[c].starRating="四星级";break;case"5":b[c].starRating="五星级"}return a}function e(a){var b=$("#title").html(),c=ejs.render(b,a);$(".header h3 span").html(c)}function f(a){var b=$("#templateList").html(),c=ejs.render(b,d(a));$(".hotel_list").append(c),$(".status").fadeOut("fast"),$(".hotel_list li").on("click",function(){$(this).addClass("cur").siblings().removeClass("cur");var a=$(this).attr("data-hotelId");j.hotelID=a,sessionStorage.setItem("hftHotelDetailPara",JSON.stringify(j)),window.location.href="hf_hotel_detail.html"})}function g(){var a=$("#loadMore");"no"!=a.attr("data-more")&&(a.attr("data-more","yes"),m.parameters.pageNo=l+1,$("#loadMore").html("正在加载..."),vlm.loadJson("",JSON.stringify(m),b))}function h(a){l=a.pageNo,a.hotels.length>0&&a.pageNo<a.pageCount?$("#loadMore").attr("data-more","").html("点击加载更多").show():a.pageNo>=a.pageCount?$("#loadMore").attr("data-more","no").html("没有更多数据了！").show():$("#loadMore").attr("data-more","").html("点击加载更多").hide()}function i(){$("#loadMore,.status").hide();var a=document.createElement("li");a.innerHTML='<div><img src="../images/hotelListNo.jpg" /><p class="hotelConSorry1">非常抱歉，无符合要求的酒店。</p><p class="hotelConSorry2">建议您扩大搜索范围</p></div>',a.className="hotelConNo",$("#hj_jList").empty().append(a).css({width:"100%",height:"100%"})}var j=JSON.parse(sessionStorage.getItem("hftChangeHotelPara"))||{},k=window.location.search;sessionStorage.setItem("hftHotelChooseUrl",k);var l,m={parameters:j,foreEndType:2,code:"50100003"};vlm.loadJson("",JSON.stringify(m),b)}();