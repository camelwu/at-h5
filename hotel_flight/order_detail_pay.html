<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="green">
    <meta name="Keywords" content="亚洲旅行网">
    <meta name="Description" content="境外专业旅行服务提供机构">
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="full-screen" content="yes">
    <meta name="x5-fullscreen" content="true">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/splash/splash-icon.png">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="images/splash/splash-icon-big.png">
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen.png" 	media="screen and (max-device-width: 320px)" />
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen@2x.png" media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen-six.png" media="(device-width: 375px)">
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen-six-plus.png" media="(device-width: 414px)">
    <link rel="apple-touch-startup-image" sizes="640x1096" href="images/splash/splash-screen@3x.png" />
    <link rel="apple-touch-startup-image" sizes="1024x748" href="images/splash/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
    <link rel="apple-touch-startup-image" sizes="768x1004" href="images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
    <link rel="apple-touch-startup-image" sizes="1536x2008" href="images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
    <link rel="apple-touch-startup-image" sizes="1496x2048" href="images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>
    <title>订单详情-已支付</title>
    <link href="../styles/framework.css" rel="stylesheet" type="text/css">
    <link href="../styles/style.css" rel="stylesheet" type="text/css">
    <link href="css/detail_amy.css" rel="stylesheet" type="text/css">
</head>

<body>
<div id="preloader">
    <div id="status-h">
        <p class="center-text"></p>
    </div>
</div>
<div class="jhf-box">
    <!--nav-->
    <div class="jhf-nav">
        <a class="j-back jpa" href="javascript:;" id = "j_back"><i></i></a>
        <div class="j-title">
            <p class="bigtit">订单详情</p>
        </div>
        <a class="j-lick phone jpa" href="tel:4008058888" id=" "></a>
    </div>
    <!--content-->
    <div class="j-content jpr" id = "jpr">
        <div class="jpay-tit">
            {% if(!isContinuePay){ %} <p class="willpay">未支付</p>{% }else{ %} <p class="hadpay">已支付 {% } %}</p>
            {% if(!isContinuePay){ var d=new Date(Date.parse(createTime.replace("T"," ").replace(/-/g, "/")));d.setMinutes(d.getMinutes()+30); %}
            <span class = "willpay-span">请在{%= d.getHours()+":"+d.getMinutes() %} 前完成支付</span>
            {% } %}
        </div>
        <!--fight-->
        <div class="jpay-t jp-fl">
            <i></i>
            <p>机票</p>
            <a href="javascript:;">详情<span></span></a>
        </div>

        <div class="jpay-c jpay-c2">
            <dl>
                <dt>
                    <i class="go"></i>
                    <span>{% var d1=new Date(Date.parse(flightInfo.flightLeaveStartDate.replace("T"," ").replace(/-/g, "/"))); %} {%=d1.getMonth()+1%}-{%=d1.getDate()%}</span>
                    <span>周{%= getWeek[d1.getDay()]%}</span>
                    <span class="more">{%=flightInfo.cityNameFrom%}</span>
                    <span>-</span>
                    <span class="more">{%=flightInfo.cityNameTo%}</span>
                    <span class="time timew">{%=flightInfo.segmentsLeaveTotalTravelTimeString%}</span>
                    <i class="time timei"></i>
                </dt>
                <dt>
                    <i class="back"></i>
                    <span>{% var d1=new Date(Date.parse(flightInfo.flightReturnStartDate.replace("T"," ").replace(/-/g, "/"))); %} {%=d1.getMonth()+1%}-{%=d1.getDate()%}</span>
                    <span>周{%= getWeek[d1.getDay()]%}</span>
                    <span class="more">{%=flightInfo.cityNameTo%}</span>
                    <span>-</span>
                    <span class="more">{%=flightInfo.cityNameFrom%}</span>
                    <span class="time timew">{%=flightInfo.segmentsReturnTotalTravelTimeString%}</span>
                    <i class="time timei"></i>
                </dt>
                <dd>头等舱+往返舱</dd>
            </dl>
            <p></p>
        </div>

        <!--hotel-->
        <div class="jpay-t jp-ht">
            <i></i>
            <p>酒店</p>
        </div>
        <div class="jpay-c jpay-c3">
            <dl>
                <dt>{%=hotelDetails.hotleName%}</dt>
                <dd><span>{%=hotelDetails.checkInDate.substring(0,10)%}</span> - <span>{%=hotelDetails.checkoutDate.substring(0,10)%}</span>
                    共<span>{%=hotelDetails.dayNum%}</span>晚（当地时间为准）</dd>
                <dd>房型：<span>{%=hotelDetails.roomDetials.roomName%}</span> 房间数：<span>{%=hotelDetails.roomDetials.numRoom%}</span>间</dd>
            </dl>
        </div>
        <div class="jpay-c jpay-c4">
            <span class="tit">订单总额：</span>
            <span class="money">￥</span>
            <span class="num jfw">{%=totalFlightPrice%}</span>
            <a class="fr" href="javscript:;">
                <i class="icon fr"></i>
                <span class="cost fr">费用明细</span>
            </a>
        </div>

        <div class="jpay-c jpay-c5" >
            <dl>
                <dt>订单信息</dt>
                <dd>
                    <span>订单号</span>
                    <p>{%=bookingRefNo%}</p>
                </dd>
                <dd>
                    <span>下单时间</span>
                    <p>{%=createTime.replace("T"," ")%}</p>
                </dd>
                <dd>
                    <span>登机人</span>
                    <p>{%=lastName%}/{%=firstName%}</p>
                </dd>
                <dd>
                    <span>护照</span>
                    <p>{%=travelers[0].idNumber%}</p>
                </dd>
                <dd>
                    <span>联系电话</span>
                    <p>{%=contactNumber%}</p>
                </dd>
                <dd>
                    <span>邮箱</span>
                    <p>{%=email%}</p>
                </dd>
            </dl>
        </div>

        <div class="jpay-c jpay-c4 jpay-c6">
            <span class="tit">联系客服</span>
            <a class="fr" href="javscript:;">
                <i class="icon fr"></i>
            </a>
        </div>
        {% if(!isContinuePay){ %}
        <div class="j-btn jpay-c7" id = "jpay_pay">
            <a href="../payment/payment.html?bookingRefNo={%=bookingRefNo%}&type=FlightHotle">支付订单</a>
        </div>
        {% } %}
    </div>
</div>
</body>
<script type="text/javascript" src="../js/lib/jquery.js"></script>
<script type="text/javascript" src="../js/lib/vlm.js"></script>
<script src="../js/lib/template.js"></script>
<script src="../js/lib/jquery.alert.js"></script>
<script>
    var getWeek = {
        "1": "一",
        "2":"二",
        "3":"三",
        "4":"四",
        "5":"五",
        "6":"六",
        "7":"日",
    };
(function(){
        var bookingRefNo=vlm.getpara("bookingRefNo");
        var Parameters={
            "Parameters":{"BookingRefNo":"SG17SINFP0375958"},
            "Code":"50100007",
            "ForeEndType":3};
        vlm.loadJson("http://10.6.11.21:1337/api/GetServiceApiResult",JSON.stringify(Parameters), function(data){
            if(data.success) {
                console.log(data.data)
                data.data.hotelDetails.dayNum = getDayNum(data.data.hotelDetails.checkInDate.replace(/T.*/,''),data.data.hotelDetails.checkoutDate.replace(/T.*/,''))
                console.log(data.data.hotelDetails.dayNum)
                var html = template("jpr", data.data);
                var dayNum = getDayNum("hotelDetails.checkInDate","hotelDetails.roomDetials");
                $("#jpr").html(html);
                vlm.init();
                $("#j_back").on("click",function(){
                    location.href="../payment/payment.html";
                });
                $("#fr").on("click",function(){
                    location.href="";
                });
            }else{
                alert("网络异常！");
            }
            function getDayNum(arg1, arg2) {
                var time1 = Date.parse(arg1.replace(/-/g, "/")), time2 = Date.parse(arg2.replace(/-/g, "/")), dayCount;
                return dayCount = (Math.abs(time2 - time1)) / 1000 / 60 / 60 / 24;
            }
        },true)
    })()
</script>
</html>