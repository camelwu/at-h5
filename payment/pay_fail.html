<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="green">
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="full-screen" content="yes">
    <meta name="x5-fullscreen" content="true">

    <meta name="Keywords" content="亚洲旅行网">
    <meta name="Description" content="境外专业旅行服务提供机构">
    <link href="../styles/style.css" rel="stylesheet" type="text/css" />
    <link href="../styles/framework.css" rel="stylesheet" type="text/css" />
    <link href="../styles/tips.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="css/pay_fail.css" />
    <title>首页 - 亚洲旅行网</title>


</head>
<body>
<!--<div id="preloader">-->
    <!--<div id="status">-->

    <!--</div>-->
<!--</div>-->
<div class="all-elements" >
    <div id="elements">
        <div class="header" id="vlm-login">
            <!--<a href="javascript:;" class="header-back" id="td_back">-->
            <!--<i class="icons go-back"></i>-->
            <!--</a>-->
            <h3>交易详情</h3>
        </div>
        <div class="tra_con1">
            <div class="tra_c1_inbox">
                <i class="payment-fail"></i>
                <span>预订失败</span>
            </div>
        </div>
        <div class="tra_con2" id = "vlm_login">
            <div class="tra_c2_inbox">
                <h3 id="tdHoteName">订单号：</h3><span>{%=bookingRefNo%}</span>
                <p class="tra_live">
                    <span id="tdCheckInDate">{%=hotelDetails.dayNum%}天{%=hotelDetails.dayNum%}晚</span>&nbsp;&nbsp;
                    <span>{%=flightInfo.cityNameTo%}{%=flightInfo.cityCodeTo%}</span><span>{%=hotelDetails.hotleName%}</span>
                </p>
                <p class="tra_price" id="tdPrice">订单总额：<span>{%=totalFlightPrice%}</span></p>
            </div>
        </div>
    </div>
    <div class="tra_btn">
        <div>
            <input type="button" value="返回首页" class="fl"  id="fl" />
        </div>
        <div class="tra_btn_div2">
            <input type="button" value="重新支付" class="fr" id="fr" />
        </div>
    </div>

    <div class="tra_footer">
        <p>版权所有 @ 2015 Asiatravel.com控股有限公司.保留所有权利</p>
    </div>
</div>
</body>
<!--<script src="js/lsf_tradeDetails.js"></script>-->
<script type="text/javascript" src="../js/lib/jquery.js"></script>
<script type="text/javascript" src="../js/lib/vlm.js"></script>
<script src="../js/lib/template.js"></script>
<script src="../js/lib/jquery.alert.js"></script>
<script type="text/javascript" src="js/payment.js"></script>
<script>
    (function(){
        var bookingRefNo=vlm.getpara("bookingRefNo");
        var Parameters={
            "Parameters":{"BookingRefNo":"SG17SINFP0375958"},
            "Code":"50100007",
            "ForeEndType":3};
        vlm.loadJson("http://10.6.11.21:1337/api/GetServiceApiResult",JSON.stringify(Parameters), function(data){
            if(data.success) {
                console.log(data.data);
                data.data.hotelDetails.dayNum = getDayNum(data.data.hotelDetails.checkInDate.replace(/T.*/,''),data.data.hotelDetails.checkoutDate.replace(/T.*/,''));
                console.log(data.data.hotelDetails.dayNum);
                var html = template("vlm_login", data.data);
                var dayNum = getDayNum("hotelDetails.checkInDate","hotelDetails.roomDetials");
                $("#vlm_login").html(html);
                vlm.init();
                $("#j_back").on("click",function(){
                    location.href="../payment/payment.html";
                });
                $("#fr").on("click",function(){
                    location.href="";
                });
            }else{
                alert("网络异常！");
            }
            function getDayNum(arg1, arg2) {
                var time1 = Date.parse(arg1.replace(/-/g, "/")), time2 = Date.parse(arg2.replace(/-/g, "/")), dayCount;
                return dayCount = (Math.abs(time2 - time1)) / 1000 / 60 / 60 / 24;
            }
        },true)
    })()
</script>
</html>