<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>景点</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="green">
    <meta name="Keywords" content="亚洲旅行网">
    <meta name="Description" content="境外专业旅行服务提供机构">
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="full-screen" content="yes">
    <meta name="x5-fullscreen" content="true">

    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/splash/splash-icon.png">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="images/splash/splash-icon-big.png">
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen.png" 	media="screen and (max-device-width: 320px)" />
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen@2x.png" media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen-six.png" media="(device-width: 375px)">
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen-six-plus.png" media="(device-width: 414px)">
    <link rel="apple-touch-startup-image" sizes="640x1096" href="images/splash/splash-screen@3x.png" />
    <link rel="apple-touch-startup-image" sizes="1024x748" href="images/splash/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
    <link rel="apple-touch-startup-image" sizes="768x1004" href="images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
    <link rel="apple-touch-startup-image" sizes="1536x2008" href="images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
    <link rel="apple-touch-startup-image" sizes="1496x2048" href="images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>
    <link href="../styles/framework.css" rel="stylesheet"/>
    <link href="../styles/style.css" type="text/css" rel="stylesheet">
    <link href="css/scenic.css" rel="stylesheet"/>
    <!--<link rel="stylesheet" type="text/css" href="css/sceniclist.css">-->
    <link href="../styles/owl.theme.css"	rel="stylesheet" type="text/css">
    <link href="../styles/tips.css"	rel="stylesheet">
</head>
<body>

    <div class="all-elements">
        <!--   顶部   -->
        <div class="header" id="vlm-login">
            <a href="../scenic/index.html" class="icons header-back"></a>
            <h3>特色当地游</h3>
            <a href="../scenic/scenic_city.html?citycode=0&callback=scenic/scenic_list.html" class="location-wrap">
            <span id="Localtxt" class="location-txt"></span>
            <i class="location-tip"></i>
            </a>
        </div>
        <!--<header class="top">-->
            <!--<a href="javascript:;" class="icons header-back"></a>-->
            <!--<h3>特色当地游</h3>-->
            <!--<a href="javascript:;" class="location-wrap">-->
                <!--<span class="location-txt">北京</span>-->
                <!--<i class="location-tip"></i>-->
            <!--</a>-->
        <!--</header>-->
        <!--   内容   -->
        <div id="content ddd" class="snap-content" style="padding-top: 45px;padding-bottom: 20px;">
            <!--<section>-->
                <!--<div class="cont-exhibition">-->
                    <!--<img src="images/palace.jpg" alt=""/>-->
                <!--</div>-->
                <!--<div class="scenic-list-box">-->
                    <!--<div class="scenic-list-choi-wrap">-->
                        <!--<a class="active">北京景点</a>-->
                        <!--<a>周边景点</a>-->
                    <!--</div>-->
                    <ul id="scenic-list-cont" class="scenic-list-box scenic-list-cont active">

                    </ul>
                    <!--<ul class="scenic-list-cont">-->
                        <!--<li class="s-li">-->
                            <!--<a href="javascript:;">-->
                                <!--<div class="sce-img-box">-->
                                    <!--<img src="images/water-cubic.jpg" alt="" class="sce-img"/ >-->
                                <!--</div>-->
                                <!--<div class="sce-detail">-->
                                    <!--<p class="sce-name-all">北京城市游：鸟巢水立方+军事博物馆一日游</p>-->
                                    <!--<div class="sce-det-fare">-->
                                        <!--<span class="sale-fare"><i>168</i> 元起/人</span>-->
                                        <!--<span class="old-fare">268元起/人</span>-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</a>-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->
            <!--</section>-->
        </div>
        <!--   底部   -->
        <!--<footer class="sce-bottom">-->
            <!--<div class="sce-filter clearFix">-->
                <!--<a href="javascript:;" class="cp-recommend"><span>产品经理推荐</span><i class="cp-recommend-tip"></i></a>-->
                <!--<a href="javascript:;" class="well-rate"><span>好评率</span><i class="well-rate-tip"></i></a>-->
                <!--<a href="javascript:;" class="price-sort"><span>价格排序<i class="price-sort-tip"></i></span></a>-->
                <!--<a href="javascript:;" class="gl-filter"><span>过滤<i class="gl-filter-tip"></i></span></a>-->
            <!--</div>-->
        <!--</footer>-->
        <footer class="sl-bottom">
            <div>
                <b class="jd-icon s-good"></b>
                产品经理推荐
            </div>
            <div>
                <b class="jd-icon s-remark"></b>
                好评率
            </div>
            <div id="priceSort">
                <b class="jd-icon s-rank"></b>
                价格排序
            </div>
            <div id="screen">
                <b class="jd-icon s-fil"></b>
                过滤
            </div>
        </footer>
        <!--      筛选块      -->
        <div id="screen_mb" class="qp-mengban"></div>
        <div id="list_screen" class="list-screen">
            <div id="quit_screen" title="chancel">取消</div>
            <div id="clear_screen" title="clear">清除筛选</div>
            <div id="sure_screen" title="confirm">确定</div>
            <ul class="scr-title">
                <li class="sctit-active">景点主题</li>
            </ul>
            <ul id="SpotScreen" class="spot-screen">

            </ul>
        </div>
    </div>
    <script src="../js/lib/jquery.js"></script>
    <script src="../js/lib/plugins.js"></script>
    <script src="../js/lib/jquery.alert.js"></script>
    <script src="../js/lib/vlm.js"></script>
    <script src="../js/lib/template.js"></script>
    <script src="../js/lib/custom.js"></script>
    <script src="../js/lib/lazyLoad.js"></script>
    <script src="js/scenic_pub.js"></script>
    <script id="tpl_Localtxt" type="text/template">
       {%=destCity%}
    </script>
    <script id="tpl_SpotScreen" type="text/template">
        <li class="spot-slected">不限<b class="jd-icon scr-gou s-active"></b></li>
        {% for(var i=0,len=data.themes.length;i<len;i++){ %}
        <li title="{%=data.themes[i].themeID%}">{%=data.themes[i].themeName%}<b class="jd-icon scr-gou"></b></li>
        {% } %}

    </script>
    <script id="tpl_SearchAvailableToursAttractions" type="text/template">
        <li class="s-li">
            <a href="../scenic/scenic_detail.html?packageID={%=packageID%}">
                <div class="sce-img-box">
                    <img  src="../images/loading-hotel.gif" data-src="{%=pictureURL%}"  class="sce-img">
                </div>
                <div class="sce-detail">
                    <p class="sce-name-all">{%=packageName%}</p>
                    <div class="sce-det-fare">
                        <span class="sale-fare"><i>{%=leadinPrice%}</i> 元起/人</span>
                    </div>
                </div>
            </a>
        </li>
    </script>
    <script>
        /*景点 目标城市列表页MT*/
        (function(){
            var val = vlm.parseUrlPara(window.location.href);
            var themeId = "";
            var defineProperty = {
                get themeId (){
                    return themeId;
                },
                set themeId (value){
                    themeId = value;
                }
            };

            vlm.init();


            /**
             * @获取景点列表
             * @constructor
             */
            MT.CLoadSearchAvailableToursAttractions = function(){

                var param=
                {
                    "Parameters": {
                        "DestCityCode": val.DestCityCode
                    },
                    "ForeEndType": 3,
                    "Code": "0087"
                };

                MT.ajaxJson("",JSON.stringify(param),MT.SearchAvailableToursAttractionsCallback,MT.ajaxAnimIn,MT.ajaxAnimOut);
            }

            /**
             * @获取景点列表 [CLoadSearchAvailableToursAttractions Callback]
             * @param data
             * @constructor
             */
            MT.SearchAvailableToursAttractionsCallback = function(data){
                var json=eval('('+data+')');
                console.log(json);
                if(json.success){
                    var data=json.data,tpl_SearchAvailableToursAttractions = template("tpl_SearchAvailableToursAttractions",data.lists),
                            tpl_Localtxt = template("tpl_Localtxt",data),
                            tpl_SpotScreen = template("tpl_SpotScreen",data);
                    $("#scenic-list-cont").html(tpl_SearchAvailableToursAttractions);
                    $("#Localtxt").html(tpl_Localtxt);
                    $("#SpotScreen").html(tpl_SpotScreen);

                    MT.CBot_screen();
                    var c = new lazyLoad("scenic-list-cont");
                    if(data.lists.length == 0){
                        jAlert("抱歉暂时没有数据","提示");
                    }
                }else {
                    console.log(json);
                    jAlert(json.message,"提示");
                }
            }

            /**
             * @价格排序
             * @constructor
             */
            MT.CBindPriceSort = function(){


                $("#priceSort").toggle(function(){
                    MT.CLoadPriceSort("HighToLow",defineProperty.themeId);
                },function(){
                    MT.CLoadPriceSort("LowToHigh",defineProperty.themeId);
                });
            }


            /**
             * @价格排序
             * @constructor
             */
            MT.CLoadPriceSort = function(priceSort,themeId){


                var param=
                {
                    "Parameters": {
                        "DestCityCode": val.DestCityCode,
                        "PriceSortType" :priceSort,
                    },
                    "ForeEndType": 3,
                    "Code": "0087"
                };
                if(themeId != ""){
                    param.Parameters.ThemeID=themeId;
                }


                MT.ajaxJson("",JSON.stringify(param),MT.PriceSortCallback,MT.ajaxAnimIn,MT.ajaxAnimOut);

            }

            /**
             * @价格排序 [CLoadSearchAvailableToursAttractions Callback]
             * @param data
             * @constructor
             */
            MT.PriceSortCallback = function(data){
                var json=eval('('+data+')');
                console.log(json);
                if(json.success){
                    var data=json.data,tpl_SearchAvailableToursAttractions = template("tpl_SearchAvailableToursAttractions",data.lists),
                            tpl_Localtxt = template("tpl_Localtxt",data),
                            tpl_SpotScreen = template("tpl_SpotScreen",data);
                    $("#scenic-list-cont").html(tpl_SearchAvailableToursAttractions);
                    $("#Localtxt").html(tpl_Localtxt);
                    $("#SpotScreen").html(tpl_SpotScreen);

                    MT.CBot_screen();
                    var c = new lazyLoad("scenic-list-cont");
                    if(data.lists.length == 0){
                        jAlert("抱歉暂时没有数据","提示");
                    }
                }else {
                    console.log(json);
                    jAlert(json.message,"提示");
                }
            }


            /**
             * @根据主题筛选
             * @param themeid
             * @constructor
             */
            MT.CLoadFilterTheme = function(themeid){

                var param=
                {
                    "Parameters": {
                        "DestCityCode": val.DestCityCode,
                        "ThemeID":themeid
                    },
                    "ForeEndType": 3,
                    "Code": "0087"
                };
                MT.ajaxJson("",JSON.stringify(param),MT.FilterThemeCallback,MT.ajaxAnimIn,MT.ajaxAnimOut);
            }

            /**
             * @根据主题筛选 [CLoadFilterTheme Callback]
             * @param data
             * @constructor
             */
            MT.FilterThemeCallback = function(data){
                var json=eval('('+data+')');
                console.log(json);
                if(json.success){
                    var data=json.data,tpl_SearchAvailableToursAttractions = template("tpl_SearchAvailableToursAttractions",data.lists);
                    $("#scenic-list-cont").html(tpl_SearchAvailableToursAttractions);
                    var c = new lazyLoad("scenic-list-cont");
                    if(data.lists.length == 0){
                        jAlert("抱歉暂时没有数据","提示");
                    }

                }else {
                    console.log(json);
                    jAlert(json.message,"提示");
                }
            }

            /**
             * 筛选主题
             * @constructor
             */
            MT.CBot_screen = function(){
                var screen = $("#screen")[0];
                var mb = $("#screen_mb")[0];
                var screenBlock = $("#list_screen")[0];
                var quit = $("#quit_screen")[0];
                var sure = $("#sure_screen")[0];
                var clear = $("#clear_screen")[0];

                //    点击筛选
                screen.onclick = function(){
                    mb.style.display="block";
                    screen.style.opacity = "1";
                    screenBlock.style.bottom=0;
                    screenBlock.style.transition="all 400ms";
                };
                //    关闭筛选
                function closeblock(){
                    mb.style.display="none";
                    screen.style.opacity = "0.8";
                    screenBlock.style.bottom=-500+'px';
                    screenBlock.style.transition="all 400ms";

                    if(this.title == "confirm"){
                        //获得themeid
                        themeid=$(".spot-slected").attr("title");
                        //调用主题方法
                        MT.CLoadFilterTheme(themeid);
                        defineProperty.themeId = themeid;
                        console.log(defineProperty.themeId);
                    }


                }

                quit.onclick = closeblock;
                sure.onclick = closeblock;
                //   筛选选择
                var li  = document.getElementsByClassName('spot-screen')[0].getElementsByTagName('li');
                var b = document.getElementsByClassName('jd-icon scr-gou');
                for(var i = 0;i < li.length;i++){

                    (function(index){
                        li[i].onclick = function(){
                            if(index==0){
                                for(var i = 0;i < li.length;i++){
                                    li[i].className = '';
                                    b[i].className = 'jd-icon scr-gou';
                                }
                                li[index].className = 'spot-slected';
                                b[index].className = 'jd-icon scr-gou s-active';
                            }else{
                                for(var j = 0;j < li.length;j++){
                                    li[j].className = '';
                                    b[j].className = 'jd-icon scr-gou';
                                }
                                li[0].className = '';
                                li[index].className = 'spot-slected';
                                b[index].className = 'jd-icon scr-gou s-active';
                            }
                        };
                    })(i);

                }
                //   清除筛选
                clear.onclick = function(){
                    li[0].className = 'spot-slected';
                    b[0].className = 'jd-icon scr-gou s-active';
                    for(var i = 1;i < li.length;i++){
                        li[i].className = '';
                        b[i].className = 'jd-icon scr-gou';
                    }
                };

            };


            MT.CBindPriceSort();
            MT.CLoadSearchAvailableToursAttractions();
            MT.CBot_screen();


        })();
    </script>
</body>
</html>
