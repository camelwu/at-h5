<!DOCTYPE html>
<head lang="zh">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="green">
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="full-screen" content="yes">
    <meta name="x5-fullscreen" content="true">
    <meta name="Keywords" content="亚洲旅行网">
    <meta name="Description" content="境外专业旅行服务提供机构">
    <title>订单详情</title>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/splash/splash-icon.png">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="images/splash/splash-icon-big.png">
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen.png" 	media="screen and (max-device-width: 320px)" />
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen@2x.png" media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen-six.png" media="(device-width: 375px)">
    <link rel="apple-touch-startup-image" href="images/splash/splash-screen-six-plus.png" media="(device-width: 414px)">
    <link rel="apple-touch-startup-image" sizes="640x1096" href="images/splash/splash-screen@3x.png" />
    <link rel="apple-touch-startup-image" sizes="1024x748" href="images/splash/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
    <link rel="apple-touch-startup-image" sizes="768x1004" href="images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
    <link rel="apple-touch-startup-image" sizes="1536x2008" href="images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
    <link rel="apple-touch-startup-image" sizes="1496x2048" href="images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>
    <link href="../styles/framework.css" rel="stylesheet" type="text/css">
    <link href="../styles/style.css" rel="stylesheet" type="text/css">
    <link href="../styles/tips.css" rel="stylesheet" type="text/css">
    <link href="css/air_ticket.css" rel="stylesheet" type="text/css">
</head>
<body>
<div id="preloader">
    <div id="status">
<<<<<<< HEAD
        
=======

>>>>>>> bugfix-20160503
    </div>
</div>
<div class="all-elements fix-background" id="detail">
    <header class="clearfix"><i class="fl" onclick="window.history.go(-1)"></i>订单详情<a href="tel:4008058888" class="ticket-order-tel"><i>&nbsp;</i></a></header>
    <div class="ticket-order-detail-content" u>
       <div class="until-pay">
         <span>{% if(isContinuePay){ %} <strong>未支付</strong>{% }else{ %} <strong>已支付</strong> {% } %}</span>
           {% if(isContinuePay){ var d=new Date(Date.parse(createTime.replace("T"," ").replace(/-/g, "/")));d.setMinutes(d.getMinutes()+30); %}
                <span>请在<strong>{%= d.getHours()+":"+d.getMinutes() %} 前完成支付</strong></span>
           {% } %}
      </div>
         <ul class="ticket-detail-information">
            {% if(routeType=="Oneway"){ %}
              <li id="LeaveInfo" class="set-start">
                  <div class="rel-start">
                      <div class="week-city-city">

                          <span><i></i></span> <span>{% var d1=new Date(Date.parse(flightInfo.flightLeaveStartDate.replace("T"," ").replace(/-/g, "/"))); %} {%=d1.getMonth()%}-{%=d1.getDate()%}</span> <span>周{%=getWeek[d1.getDay()]%} {%=flightInfo.cityNameFrom%} - {%=flightInfo.cityNameTo%}</span>
                      </div>
                      <div class="time-arrow-time">
                          <div class="city-time-left">
                               <div class="clock">{%=vlm.Utils.format_date(flightInfo.segmentsLeave[0].departDate,"hm")%}</div>
                               <p class="port-name">{%=flightInfo.segmentsLeave[0].airportNameFrom%}{%=flightInfo.segmentsLeave[0].TermDepart%}</p>
                          </div>
                          <div class="time-arrow">
                               <!--<h6>2h3m</h6>-->
                               <div class="icon-arrow"></div>
                          </div>
                          <div class="city-time-right">

                              <div class="clock"> {%=vlm.Utils.format_date(flightInfo.segmentsLeave[0].arriveDate,"hm")%}</div>
                              <p class="port-name">{%=flightInfo.segmentsLeave[0].airportNameTo%}{%=flightInfo.segmentsLeave[0].TermArrive%}</p>
                          </div>
                      </div>
                      <div class="nation-flight-number">
                          <span>{%=flightInfo.segmentsLeave[0].airCorpName%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[0].marketingCarrierCode%}{%=flightInfo.segmentsLeave[0].flightNo%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[0].planeName%}<span></span></span>
                      </div>
                  </div>
                  {% if(flightInfo.segmentsLeave.length>1){  for(var i=1; i<=flightInfo.segmentsLeave.length-1;i++){ %}
                      <p class="transit-word-city">中转{%=flightInfo.segmentsLeave[1].cityNameFrom%}</p>
                      <div class="rel-transit">
                          <div class="time-arrow-time">
                              <div class="city-time-left">
                                  <div class="clock"> {%=vlm.Utils.format_date(flightInfo.segmentsLeave[i].departDate,"hm")%}</div>
                                  <p class="port-name">{%=flightInfo.segmentsLeave[i].airportNameFrom%}{%=flightInfo.segmentsLeave[i].TermDepart%}</p>
                              </div>
                              <div class="time-arrow">
                                  <!--<h6>2h30m</h6>-->
                                  <div class="icon-arrow"></div>
                              </div>
                              <div class="city-time-right">

                                  <div class="clock">{%=vlm.Utils.format_date(flightInfo.segmentsLeave[i].arriveDate,"hm")%}</div>
                                  <p class="port-name">{%=flightInfo.segmentsLeave[i].airportNameTo%}{%=flightInfo.segmentsLeave[i].TermArrive%}</p>
                              </div>
                          </div>

                          <div class="nation-flight-number">
                              <span>{%=flightInfo.segmentsLeave[i].airCorpName%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[i].marketingCarrierCode%}{%=flightInfo.segmentsLeave[i].flightNo%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[i].planeName%}<span></span></span>
                          </div>
                      </div>
                  {% }} %}
             </li>
            {% }else{ %}
             <li id="LeaveInfo" class="set-start">
                 <div class="rel-start">
                     <div class="week-city-city">
                         <span><i></i></span> <span> {%=vlm.Utils.format_date(flightInfo.flightLeaveStartDate,"hm")%}</span> <span>周{%=getWeek[d1.getDay()]%} {%=flightInfo.cityNameFrom%} - {%=flightInfo.cityNameTo%}</span>
                     </div>
                     <div class="time-arrow-time">
                         <div class="city-time-left">

                             <div class="clock">{% var d2= new Date(Date.parse(flightInfo.segmentsLeave[0].departDate.replace("T"," ").replace(/-/g, "/"))); %} {%=d2.getHours()%}:{%=d2.getMinutes()%}</div>
                             <p class="port-name">{%=flightInfo.segmentsLeave[0].airportNameFrom%}{%=flightInfo.segmentsLeave[0].TermDepart%}</p>
                         </div>
                         <div class="time-arrow">
                             <!--<h6>2h3m</h6>-->
                             <div class="icon-arrow"></div>
                         </div>
                         <div class="city-time-right">

                             <div class="clock"> {%=vlm.Utils.format_date(flightInfo.segmentsLeave[0].arriveDate,"hm")%}</div>
                             <p class="port-name">{%=flightInfo.segmentsLeave[0].airportNameTo%}{%=flightInfo.segmentsLeave[0].TermArrive%}</p>
                         </div>
                     </div>
                     <div class="nation-flight-number">
                         <span>{%=flightInfo.segmentsLeave[0].airCorpName%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[0].marketingCarrierCode%}{%=flightInfo.segmentsLeave[0].flightNo%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[0].planeName%}<span></span></span>
                     </div>
                 </div>
                 {% if(flightInfo.segmentsLeave.length>1){  for(var i=1; i<=flightInfo.segmentsLeave.length-1;i++){ %}
                 <p class="transit-word-city">中转{%=flightInfo.segmentsLeave[1].cityNameFrom%}</p>
                 <div class="rel-transit">
                     <div class="time-arrow-time">
                         <div class="city-time-left">
                             <div class="clock">{%=vlm.Utils.format_date(flightInfo.segmentsLeave[i].departDate,"hm")%}</div>
                             <p class="port-name">{%=flightInfo.segmentsLeave[i].airportNameFrom%}{%=flightInfo.segmentsLeave[i].TermDepart%}</p>
                         </div>
                         <div class="time-arrow">
                             <!--<h6>2h30m</h6>-->
                             <div class="icon-arrow"></div>
                         </div>
                         <div class="city-time-right">

                             <div class="clock">{%=vlm.Utils.format_date(flightInfo.segmentsLeave[i].arriveDate,"hm")%}</div>
                             <p class="port-name">{%=flightInfo.segmentsLeave[i].airportNameTo%}{%=flightInfo.segmentsLeave[i].TermArrive%}</p>
                         </div>
                     </div>

                     <div class="nation-flight-number">
                         <span>{%=flightInfo.segmentsLeave[i].airCorpName%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[i].marketingCarrierCode%}{%=flightInfo.segmentsLeave[i].flightNo%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[i].planeName%}<span>(大)</span></span>
                     </div>
                 </div>
                 {% }} %}
             </li>
             <li class="set-start set-back">
                 <div class="rel-start">
                     <div class="week-city-city">
                         <span><i></i></span> <span>{% var d1=new Date(flightInfo.segmentsReturn[0].departDate.replace("T"," ")); %} {%=d1.getMonth()%}-{%=d1.getDate()%}</span> <span>周{%=getWeek[d1.getDay()]%} {%=flightInfo.cityNameTo%}-{%=flightInfo.cityNameFrom%}</span>
                     </div>

                     <div class="time-arrow-time">
                         <div class="city-time-left">

                             <div class="clock">{% var d3=new Date(Date.parse(flightInfo.segmentsReturn[0].departDate.replace("T"," ").replace(/-/g, "/"))); %} {%=d3.getHours()%}:{%=d3.getMinutes()%}</div>
                             <p class="port-name">{%=flightInfo.segmentsReturn[0].airportNameFrom%}{%=flightInfo.segmentsReturn[0].TermArrive%}</p>
                         </div>
                         <div class="time-arrow">
                             <h6></h6>
                             <div class="icon-arrow open"></div>
                         </div>
                         <div class="city-time-right">

                             <div class="clock">{% var d2= new Date(Date.parse(flightInfo.segmentsReturn[0].arriveDate.replace("T"," ").replace(/-/g, "/")));%} {%=d2.getHours()%}:{%=d2.getMinutes()%}</div>
                             <p class="port-name">{%=flightInfo.segmentsReturn[0].airportNameTo%}{%=flightInfo.segmentsReturn[0].TermArrive%}</p>
                         </div>
                     </div>

                      <div class="nation-flight-number back-flight">
                        <div class="p"><div class="left-item"> <span>{%=flightInfo.segmentsReturn[0].airCorpName%}</span><span>|</span><span>{%=flightInfo.segmentsReturn[0].marketingCarrierCode%}{%=flightInfo.segmentsReturn[0].flightNo%}</span><span>|</span><span>{%=flightInfo.segmentsLeave[0].planeName%}<span></span></span></div><div class="right-item"></div></div>
                      </div>
                     {% if(flightInfo.segmentsReturn.length>1){  for(var i=1; i<=flightInfo.segmentsReturn.length-1;i++){ %}
                     <p class="transit-word-city">中转{%=flightInfo.segmentsReturn[1].cityNameFrom%}</p>
                     <div class="time-arrow-time">
                         <div class="city-time-left">

                             <div class="clock">{% var d3=new Date(Date.parse(flightInfo.segmentsReturn[i].departDate.replace("T"," ").replace(/-/g, "/"))); %} {%=d3.getHours()%}:{%=d3.getMinutes()%}</div>
                             <p class="port-name">{%=flightInfo.segmentsReturn[i].airportNameFrom%}{%=flightInfo.segmentsReturn[i].TermArrive%}</p>
                         </div>
                         <div class="time-arrow">
                             <h6></h6>
                             <div class="icon-arrow open"></div>
                         </div>
                         <div class="city-time-right">
                             <div class="clock">{% var d2= new Date(Date.parse(flightInfo.segmentsReturn[i].arriveDate.replace("T"," ").replace(/-/g, "/")));%} {%=d2.getHours()%}:{%=d2.getMinutes()%}</div>
                             <p class="port-name">{%=flightInfo.segmentsReturn[i].airportNameTo%}{%=flightInfo.segmentsReturn[i].TermArrive%}</p>
                         </div>
                     </div>

                     {% }} %}
                 </div>
             </li>
             {% } %}
        </ul>
       <div class="order-summary" id="allPrice">
        <span>订单总额：<span>￥</span><strong>{%=totalFlightPrice%}</strong></span>
        <span>费用明细<i></i></span>
    </div>
       <div class="order-summary-information">
        <h4>订单信息</h4>
         <p>
            <span class="first">订单号</span><span>{%=bookingRefNo%}</span>
        </p>
        <p>
            <span class="first">下单时间</span><span>{%=createTime.replace("T"," ")%}</span>
        </p>
        <p>
            <span class="first">登机人</span><span>{%=lastName%}/{%=firstName%}</span>
        </p>
        <p>
            <span class="first">护照</span><span>{%=travelers[0].idNumber%}</span>
        </p>
        <p>
            <span class="first">联系电话</span><span><a href="tel:{%=contactNumber%}">{%=contactNumber%}</a></span>
        </p>
        <p>
            <span class="first">邮箱</span><span>{%=email%}</span>
        </p>
    </div>
        <div class="contact-service"><span><a href="tel:888888888888">联系客服</a></span> <i></i></div>
        {% if(isContinuePay){ %}
          <div class="button">
           <button type="button" class="pay-button"><a href="../payment/payment.html?bookingRefNo={%=bookingRefNo%}&type=Flight">支付订单</a></button>
    </div>
        {% } %}
    </div>
</div>
<div class="mb"></div>
<div class="contact-wrap">
<<<<<<< HEAD
    <p>400 805 8888</p>
    <div class="buttons">
        <button type="button" class="cancel">取消</button>
        <button type="button" class="call"><a href="tel:400 805 8888">拨打</a></button>
=======
    <p>4008-902-202</p>
    <div class="buttons">
        <button type="button" class="cancel">取消</button>
        <button type="button" class="call"><a href="tel:4008-902-202">拨打</a></button>
>>>>>>> bugfix-20160503
    </div>
</div>
<!--客服电话-->
<div class="jpop_box_tic" style="display: none;">
    <dl>
<<<<<<< HEAD
        <dt>400 805 8888</dt>
        <dd><span>取消</span><a href="tel:+4008058888">拨打</a></dd>
=======
        <dt>4008-902-202</dt>
        <dd><span>取消</span><a href="tel:4008-902-202">拨打</a></dd>
>>>>>>> bugfix-20160503
    </dl>
</div>

<!--      费用明细块      -->
<div id="pdetail_mb" class="od-mb"></div>
<div id="pd_block" class="pd-block">
    <ul id="pd_list" class="pd-list">
        <li>
            <div>成人×{%=numofAdult%}</div>
            <div>￥{%=numofAdult*flightInfo.totalFareAmountADT%}</div>
        </li>
        <li>
            <div>成人税费×{%=numofAdult%}</div>
            <div>￥{%=numofAdult*flightInfo.totalTaxAmountADT%}</div>
        </li>
        <li>
            <div>儿童×{%=numofChild%}</div>
            <div>￥{%=numofChild*flightInfo.totalFareAmountCHD%}</div>
        </li>
        <li>
            <div>儿童税费×{%=numofChild%}</div>
            <div>￥{%=numofChild*flightInfo.totalTaxAmountCHD%}</div>
        </li>
        <li>
            <div>总价</div>
            <div>￥{%=totalFlightPrice%}</div>
        </li>
    </ul>
</div>

<script src="../js/lib/jquery.js"></script>
<script src="../js/lib/jquery.alert.js"></script>
<!--<script src="../js/lib/vcm.js"></script>-->
<script type="text/javascript" src="js/hy_ticket_order_detail.js"></script>
<script src="../js/lib/plugins.js"></script>
<script src="../js/lib/vlm.js"></script>
<script src="../js/lib/template.js"></script>
<script>
    var getWeek = {
        "1": "一",
        "2":"二",
        "3":"三",
        "4":"四",
        "5":"五",
        "6":"六",
        "7":"日",
    };
    var getStateCN = {
        "Paid": "已支付",
        "Pending":"未支付"
    };

    (function(){
        var ww = this;
        var orderDetail = function(){
            //   加载详情数据
            var getDetailData = function(){
                var bookingRefNo=vlm.getpara("bookingRefNo");
                var tmp = {
                    "Parameters": {"BookingRefNo":bookingRefNo },
                    "ForeEndType": 3,
                    "Code": "3006"
                };
                vlm.loadJson("",JSON.stringify(tmp),getDetail_back);
                function getDetail_back(json){
                    if(json.success){
                        var data=json.data;
                        var tpl=template("detail",data);
                        var tplD=template("pd_list",data);
                        $("#detail").html(tpl);
                        $("#pd_list").html(tplD)
                        console.log(data);
                        showPriceDetail();
                        $(".contact-service").on("click",function(){
                            $(".jpop_box_tic").show();
                        })
                        $('.jpop_box_tic span,.jpop_box_tic a').click(function(){
                            $('.jpop_box_tic').hide();
                        })
                        vlm.init();
                    }else {
                        jAlert(json.message,"提示");
                    }
                }
            };
            var showPriceDetail = function(){
                var allPrice = $('#allPrice')[0];
                var pdetail_mb = $('#pdetail_mb')[0];
                var pd_block = $('#pd_block')[0];
                allPrice.onclick = function(){
                    pdetail_mb.style.display = "block";
                    pd_block.style.bottom = 0;
                    pd_block.style.transition="all 400ms";
                };
                pdetail_mb.onclick = function(){
                    pdetail_mb.style.display = "none";
                    pd_block.style.bottom = -350+'px';
                    pd_block.style.transition="all 400ms";

                }
            };
            return{
                GetDetailData:getDetailData,
                ShowPriceDetail:showPriceDetail
            }
        }();
        ww.MT = ww.MT || {};
        ww.MT.load = function(){
            orderDetail.GetDetailData();
            orderDetail.ShowPriceDetail()
        };
        MT.load();
    })()

</script>
</body>
<<<<<<< HEAD
</html>
=======
</html>
>>>>>>> bugfix-20160503
